** 5.4 고유벡터와 선형변환
   행렬의 인수분해(행렬분해)도 선형변환이다.
*** 선형변환의 행렬
    벡터공간 V에서 W로의 선형변환T가 x에서 T(x)로 변할 때 
    V의 기저B의 좌표점에서 W의 기저C의 좌표점으로 변환하는 것도 마찬가지로 선형변환T가 된다.
    입력은 x를 B의 선형결합으로 나타낸 것이고 출력은 T(x)를 C의 선형결합으로 나타낸 것이다.
    이때 사용되는 표준행렬(선형변환에 사용되는 행렬)을 *기저B와 C에 관련된 T에 대한 행렬* 이라고 부른다.
    이 행렬은 그 열들이 기저B의 각 열벡터에 대한 변환T(즉 T(b_{k}))를 기저C의 선형결합으로 나타낸 것을 순서대로 나열한 것이다.
    (앞의 기저 파트에서 특정 기저좌표를 단위좌표로 바꾸는 좌표변환행렬을 공부했다. 이것이 사용된다.)
*** V에서 V로의 선형변환
    앞에서는 다른 공간 사이의 변환을 상정했는데 이제는 같은 공간 내에서의 변환을 다루어 보자.
    그러면 사용되는 기저는 하나이다. 그렇다면 위에서 본 행렬M은 책에서는 *T에 대한 B행렬* 을 일반적인 표현으로 사용한다.
    (하지만 정확히는 하나의 기저에 관계된 T에 대한 행렬이나 T에 대한 특정기저행렬이라고도 하는게 맞지 않나?)
    어쨌든 이것을 *변환 x|->Ax의 B행렬* 이라고도 표현한다. (그렇다면 *T의 B행렬* 로 간략화해도 될까?)
    $$ [T(x)]_{B} = [T]_{B}[x]_{B} $$
**** T에 대한 B행렬을 어떻게 구할까?
     먼저 기저B의 각 벡터들을 하나씩 T로 변환시킨다.
     그 다음 변형된 것들을 B에 관한 좌표로 변경한다
     이 벡터좌표들을 순서대로 모아서 하나의 행렬을 만들면 그것이 T에 대한 B행렬이다.
     실제 변환T는 이 행렬과 기저로 구성된 선형결합 중 상수부분에 대한 벡터의 곱이 된다.
     P_{n} 다항식 공간 내에서의 변환을 R^{n+1} 차원 내에서의 변환으로 바꾸어 보는 것이 이것의 예가 될 수 있다. 
*** R^{n}에서의 선형변환
    n정방행렬이 있을 경우 R^{n} 내부에서의 선형변환T x에서 Ax로의 변환이 있고 
    A가 대각화가능행렬이라면 A의 고유벡터로 구성된 기저B가 존재한다.
    이렇게 되면 정리8에 의하여 T에 대한 B행렬이 대각행렬이 된다.
    #+BEGIN_QUOTE
    정리8. 대각행렬 표시\\
    A = PDP^{-1} 라면 D는 n대각행렬이다. 
    만약 기저B가 행렬P의 열벡터로 만든 R^{n}에 대한 기저이면 D는 변환 x|->Ax의 B행렬(T에 대한 B행렬)이다.
    #+END_QUOTE
    (여기서 드디어 가역행렬을 굳이 P로 이름지은 이유가 등장한다.
    기저 간의 변환에 사용되는 4.4절의 좌표변환행렬P가 행렬분해에 등장하는 가역행렬P이기도 한 것이다.)
    증명방법: 좌표변환행렬P와 B에 관한 x의 좌표의 곱이 곧 x이다. 여기에 좌표변환행렬의 역행렬을 양변좌측에 곱하면
    B에 관한 x의 좌표는 P^{-1}와 x의 곱이 된다.
    이제 T에 대한 B행렬을 구해보자.
    기저B의 각 벡터를 T에 적용한 것을 B에 관한 좌표로 나타낸 벡터를 모으면 된다.
    B에 관한 x의 좌표는 P^{-1}x 였음을 앞에서 보았는데 여기 x에 위 각 벡터가 대응된다.
    따라서 P^{-1}T(b_{k}) 형태의 열벡터들이 나타난다.
    T(x) = Ax 임을 여기에 적용하면 각 열벡터들은 P^{-1}Ab_{k} 형태가 되는데 
    앞의 공통된 P^{-1}A를 묶어내면 뒷부분은 좌표변환행렬 P가 된다.
    즉 T에 관한 B행렬은 P^{-1}AP 인데 그렇다면 T에 관한 B행렬은 A와 닮음이고 
    A=PDP^{-1} 와의 관계에 따라서 대각행렬 D가 됨을 알 수 있다.

    또한 동일공간 내에서의 선형변환에는 다른 기저에 대한 같은 선형변환이 있을 수 있다.
    이를테면 단위기저에서의 선형변환과 기저B에서의 선형변환은 같은 선형변환일 수 있다.

*** 행렬표현의 닮음
    (기저벡터로 구성된 행렬이 해당 기저좌표를 단위좌표로 바꿔주는 좌표변환행렬이 된다는 점은 당연하지만 흥미롭다.)    
**** 표준행렬A가 대각행렬C와 닮음인지 검토
     행렬분해 A=PCP^{-1} 가 있으면 
     P는 기저좌표를 단위좌표로 바꿔주는 변환행렬이며
     P^{-1}는 단위좌표를 기저좌표로 바꿔주는 변환행렬인 것이고
     C는 기저좌표계 내부에서 수행되는 변환T이다. 기저좌표 x가 있다면 이것을 기저좌표계의 T(x)로 바꿔주는 것이다.
     재밌는 점은 P, C, P^{-1}를 순서대로 적용한 것을 설명해 보면
     단위좌표 x를 기저좌표로 바꾸고 기저좌표 내에서 T(x)를 수행한 결과를 다시 단위좌표로 바꾸는 것이 된다.
**** 반대로 변환T에 대한 B행렬(대각행렬C)이 표준행렬A와 닮음인지 역으로 검토할 수도 있다.
**** Jordan형식
     A가 대각화가 불가능하여도 기저B는 변환 x|->Ax에 대한 B행렬(B행렬로 축약표현)의 성질을 가질 수 있다. 이것을 A의 *Jordan형식* 이라 한다. 즉 어떤 행렬이 대각화가 불가능함에도 단위좌표계 내에서의 선형변환에 대응하여 기저좌표계 내에서의 선형변환을 수행하는 표준행렬이 존재하는 것을 조던 형태라고 부른다.(고 생각된다)
***** 어떤 행렬이 조던 형태일때 어떻게 B행렬을 구할까?
      고유공간 차원의 합계가 정방행렬의 차원에 미치지 못하면 대각불능이다.
      이럴 지라도 기저가 있다면 그 기저는 여전히 P가 될 수 있다.
      그렇다면 P^{-1}AP 를 계산할 수 있으므로 B행렬을 구할 수 있다.

    (여기서 운만 띄워놓고 뒷장에서 점차 연결된 내용이 나오지 않을까 추측한다.)

    #+BEGIN_QUOTE
    수치적 유의사항: B행렬의 효과적 계산법\\
    AP를 먼저 계산한 뒤 [P AP] 를 [I P^{-1}AP] 로 축약하면 
    P^{-1}을 따로 안 구해도 된다.
    #+END_QUOTE
    (P를 I로 행축약하는 연산을 요소행렬로 모아 곱하면 P^{-1}가 되는 것을 이용함)

