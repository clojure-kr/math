* 2 행렬 대수 Matrix Algebra

** 2.1 행렬연산(Matirx Operations)
행렬의 합과 곱 연산은 산술의 합과 곱 연산과 비슷한 면들도 있고 다른 면도 있다.
행렬성분에 행번호와 열번호를 의미하는 i,j를 붙여서 표기한다.
*대각성분(diagonal entries)* 이란 행과 열 번호가 같은 성분들이다. 대각성분들이 *주대각선(main diagonal)* 을 이룬다.
*대각행렬(diagonal matrix)* 이란 비대각성분이 0인 행렬이다.
*** 합과 스칼라(scaler)곱(상수곱) (Sums and scaler multiples)
*행렬이 같다* 는 것은 크기와 대응성분이 같다는 것을 의미한다.
*행렬의 합* 은 같은 크기에서만 가능하다. 대응되는 열벡터의 합으로 볼 수 있으며 실제 계산은 벡터의 대응 성분의 합이 된다. 합의 결과 역시 크기가 같다.
*상수곱* 은 행렬의 각 열에 상수를 곱한 것이다.

#+BEGIN_QUOTE
정리1 A,B,C는 같은 크기 행렬이고, r,s는 상수다.
1. A + B = B + A             교환법칙
2. (A + B) + C = A + (B + C) 행렬의 합은 결합법칙이 적용된다.
3. A + 0 = A                 행렬합의 항등원은 0벡터
4. r(A + B) = rA + rB        왼쪽 분배
5. (r + s)A = rA + sA        오른쪽 분배
6. r(sA) = (rs)A             상수곱과의 결합
#+END_QUOTE

*** 행렬의 곱(Matrix multiplications)
선형변환의 합성을 행렬곱으로 표현할 수 있다. 행렬곱은 벡터의 선형결합과 가중치의 곱으로 변환할 수 있다.
곱이 되려면 선행행렬의 열의 개수와 후행행렬의 행의 개수가 맞아야 한다. 

#+BEGIN_CENTER
*곱 AB의 정의*
전제: A는 m x n 행렬, B는 b1,...,bp를 열로 하는 n x p 행렬
AB는 Ab1,...Abp인 m x p 행렬이다.
*AB = A[b1 ... bp] = [Ab1 ... Abp]*
#+END_CENTER

AB의 각 열은 (대응하는 B의 열을 가중치로 취하는) A의 열들의 일차결합이다. (AB)j = [a1 ... ai]bj
AB의 각 성분은 *(AB)ij = ai1b1j + ai2b2j + ... + ainbnj* 이다.
AB의 각 행은 ai 곱하기 B다. (AB)i = aiB 

*** 행렬의 곱에 관한 성질(Properties of matirx multiplications)
#+BEGIN_QUOTE
정리2 m x n 행렬 A가 B,C 행렬과 합과 곱을 할 경우 다음이 성립한다.
1. A(BC) = AB(C)        결합법칙
2. A(B + C) = AB + AC   왼쪽 분배법칙
3. (A + B)C = AC + BC   오른쪽 분배법칙
4. r(AB) = (rA)B = A(rB)  r∈R  행렬곱에서 상수교환은 가능하나 행렬교환은 일반성이 없다.
5. ImA = A = AIn        행렬의 곱에 대한 항등원
#+END_QUOTE

1. AB BA는 일반적으로 같지 않다. 같은 경우 행렬을 교환가능(communitative)하다고 한다.
2. 좌우변에 같은 행렬이 있다고 소거할 수 없다.
3. 행렬곱이 영행렬이라고 개 중에 영행렬이 있다고 단정할 수 없다.

*** 행렬의 거듭제곱(Powers of a Matrix)
가능하다. 지수가 0인 것을 항등행렬로 볼 수 있다.

*** 행렬의 전치(The transpose of a Matrix)
행렬의 행과 열을 바꾼 것이다.

#+BEGIN_QUOTE
정리3
1. (AT)T = A
2. (A + B)T = AT + BT
3. (rA)T = rAT
4. (AB)T = BTAT 
#+END_QUOTE

행렬곱의 전치는 각 전치행렬의 역순의 곱과 같다.
행렬곱을 빨리하는 방법은 연속된 행렬의 곱 중 곱의 결과가 더 작게 축소되는 것을 먼저 계산하는 것이다. 

** 2.2 행렬의 역(역행렬) (The inverse of a matrix)
행렬의 역은 실수의 역수와 비슷한 면도 있고 다른 면도 있다.
역행렬 중 정방행렬만이 앞으로 다루는 법칙들이 적용된다.
행렬이 *가역적(invertible)* 이란 역행렬이 존재한다는 의미다. 
가역행렬은 nonsingular matrix, 비가역행렬은 singular matrix다.
#+BEGIN_QUOTE
정리4 2x2 행렬A의 행렬식(determinant)
A = [[a b] [c d]] 이고 ab - bc ≠ 0 이면 A는 가역이고
A-1 = 1/(ad-bc)[[d -b] [-c a]]
만약 ad-bc=0이면 비가역이다.
#+END_QUOTE

#+BEGIN_QUOTE
정리5 가역행렬방정식의 해는 유일하다
전제: n x n 행렬A, b∈Rn
Ax=b는 유일한 해 x=A-1b를 갖는다.
#+END_QUOTE
위 증명에서 유일성을 증명하려면 임의의 해도 역시 A-1b가 됨을 증명하면 된다.

탄성막대의 구부러짐 y는 유연성행렬 D와 힘의 곱이다. y=Df
역으로 탄성막대에 가해진 힘은 강성행렬과 유연성의 곱이다. f=D-1y

#+BEGIN_QUOTE
정리6 가역행렬의 성질
1. 가역행렬의 역행렬도 가역행렬이다. 가역행렬의 역행렬을 다시 역하면 가역행렬이 된다.
(A-1)-1 = A
2. 행렬곱의 역행렬은 각 행렬의 역행렬의 역순 곱이다.
(AB)-1 = B-1A-1
3. 가역행렬의 전치행렬도 가역행렬이다. 가역행렬의 전치행렬의 역은 역행렬의 전치행렬이다.
(AT)-1 = (A-1)T
#+END_QUOTE 

*** 기본행렬(elementary matrix)
항등행렬에 행연산을 아무거나 1회 실시한 행렬이다. 일반행렬에 행해지는 1회의 행연산을 담고 있다.
따라서 행렬A에 행연산E를 1회 실시한 경우 EA가 된다.
기본행렬의 역행렬 역시 기본행렬이다. 기본행렬의 역행렬은 기본행렬을 항등행렬로 되돌린다.

#+BEGIN_QUOTE
정리7 가역의 필요충분조건, 행연산의 또 다른 효과
행렬이 항등행렬과 행동치인 것이 가역의 필요충분조건이다.
행렬을 항등행렬로 바꾸는 행연산은 항등행렬을 역행렬로 바꿔준다.
#+END_QUOTE 
행렬을 항등행렬로 바꾸는 행연산은 기본행렬의 연속된 곱과 같다. 이 연속된 곱을 항등행렬에 적용하면 역행렬이 된다.

*** A-1 구하는 알고리즘
[A I]의 기약 사다리꼴을 구해서 A부분이 I로 바뀌면 A는 가역행렬이고 I가 아니면 비가역이다.
가역이면 I부분이 바뀐 부분이 A의 역행렬이 된다.

*** 역행렬에 대한 다른 관점
I = [e1...en] 이면 [A I]는 다수의 방정식 Ax=e1 ... Ax=en으로 볼 수 있다.
우리는 AA-1 = I 임을 알고 있다. 따라서 위 방정식들의 해는 A-1의 각 열임을 알 수 있다.
역행렬의 일부 열만 구할 필요가 있을 때 이것을 이용하면 된다.
행렬방정식의 해를 구하는 방법으로 역행렬을 직접 구하는 것은 비효율적이다. 
행렬과 단위행렬의 첨가행렬을 축약시켜서 구하는 것이 좋은 방법이다. 

** 2.3 가역행렬의 특성화(Characterizaions of invertible matrix)
#+BEGIN_QUOTE
정리8 가역행렬정리(IMT - Invertible Matrix Theorem)
전제: n x n 행렬 A
다음 명제들은 동치라서 모두 참이거나 모두 거짓이다.
1. A는 가역행렬이다.
2. A는 I와 행동치다.
3. A는 모든 열에 추축위치를 갖는다.
4. Ax=0은 자명한 해만 갖는다.
5. A의 열들은 일차독립인 집합을 이룬다.
6. x|->Ax는 일대일이다.
7. Rn의 각 b에 대하여 방정식 Ax=b는 적어도 하나의 해를 갖는다. (정리5는 유일한 해)
8. A의 열들이 Rn을 생성한다.
9. x|->Ax는 Rn을 Rn위로 사상한다.(전사변환)
10. CA=I 만족하는 n x n 행렬C 존재한다.
11. AD=I 만족하는 n x n 행렬D 존재한다.
12. AT는 가역행렬이다.
#+END_QUOTE

AB=I면 A,B 모두 가역행렬이고 B=A-1, A=B-1이다.

정리8을 모조리 부정하면 비가역행렬 즉 특이행렬이 된다.

*** 가역선형변환(Invertible linear transformations)
행렬곱이 선형변환의 합성이므로 A-1Ax=x도 선형변환의 합성이다.
즉 선형변환의 가역변환도 존재하며 선형변환 결과를 가역변환시키면 도로 정의역이 된다.
#+BEGIN_QUOTE
정리9 선형변환이 가역적이 되려면 표준행렬이 가역적이여야 한다. 
#+END_QUOTE

가역변환은 전사함수이다.
일대일 선형변환은 그 표준행렬의 열들이 일차독립이다. 따라서 표준행렬은 가역적이다. 그러므로 전사변환이다. 이 선형변환도 가역적이다.

#+BEGIN_QUOTE
수치적 유의사항
가역행렬 중에도 거의 특이적이거나 성분 몇개만 바뀌면 특이행렬인 것들이 있다. 이런 것들은 수치계산의 반올림 오차로 가역을 특이로 특이를 가역으로 오인할 수 있다.
어떤 프로그램은 특이에 가까운 정도를 나타내는 조건수를 계산하는데 항등행렬은 1이고 특이행렬은 무한이다. 이 조건수가 크면 계산오류가 나기 쉽다.
#+END_QUOTE

** 2.4 분할행렬(Partitioned Matrices)
하나의 행렬을 여러개의 블록으로 분할하면 블록들을 요소로하는 분할행렬이 된다.
*** 분할행렬의 합과 상수곱
대응되는 블록의 합이 곧 분할행렬의 합이고, 대응되는 블록의 상수곱이 분할행렬의 상수곱이다.

*** 분할행렬곱
앞의 행렬의 열분할이 뒤의 행렬 행분할과 일치하게 분할되면 가능하다.
#+BEGIN_QUOTE
전제: m x n 행렬A, n x p 행렬B
AB = [col1(A) ... coln(A)][row1(B) ... rown(B)]
   = [col1(A)row1(B) ... coln(A)rown(B)]
#+END_QUOTE

*** 분할행렬의 역
만약 분할행렬의 블럭 중에 가역행렬이 있다면, 분할행렬과 같은 크기의 임의의 행렬을 가상의 역행렬로 배치하여 행렬곱을 구성하고 그 우변에 분할행렬의 항등행렬을 배치한다. 각 행렬의 블럭끼리 곱하여 선형방정식계를 얻을 수 있는데 가역블럭과 역블럭과의 곱이 항등블럭이 됨을 이용하여 소거함으로써 역분할행렬의 각 블럭을 원본 분할행렬의 역행들로 변환할 수 있다.
