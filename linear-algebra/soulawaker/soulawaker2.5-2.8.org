* 2.5 행렬분해(Matrix Factorizations)
행렬곱은 데이터 합성에 행렬분해는 데이터 해석에 관계된다.

** LU분해(LU Factorizations)
같은 계수행렬을 가지는 행렬방정식 수열을 빨리 풀기 위한 방법으로 고안되었다. 
수열 중 첫번째 방정식을 행축약으로 풀면서 계수행렬의 LU분해를 얻어낼 수 있다.  
L은 단위하삼각행렬 unit Lower triangular matrix이고
U는 평행사변형 행렬이다.
L은 별도의 추가 연산 없이 행축약 연산 과정만으로도 구해진다.

** LU분해 알고리즘(An LU Factorization algorithm)
행축약을 *행교체* 연산만으로 수행할 때 그 행연산들은 단위하삼각 기본행렬(unit Lower triangular elementary matrix)들의 곱으로 표현될 수 있다. 이 단위하삼각 기본행렬들의 곱의 역행렬을 구하면 단위하삼각행렬을 구할 수 있다.
Ep...E1A = U
A = (Ep...E1)^-1U
L = (Ep...E1)^-1
(Ep...E1)L = (Ep...E1)(Ep...E1)^-1 = I  따라서 L은 가역적이다.
L^-1 = (Ep...E1)
L^-1A = U
A = LU

#+BEGIN_QUOTE
LU분해를 위한 알고리즘.
1. 가능하면 *행교체* 연산들의 수열로 A를 U로 축약해라.
2. 같은 행연산들의 수열이 L을 I로 축약하게 L의 요소들을 배치해라.
#+END_QUOTE

1단계가 된다면 LU분해가 된다는 것이다. 
2단계는 주대각선 아래 영역을 비워둔 단위하삼각행렬을 두고 A의 대응되는 열에서 추축위치 이하의 요소를 옮겨 적는다.
그리고 추축위치를 모두 1로 만들기 위하여 해당 열을 각 추축위치 값으로 모두 나누면 단위하삼각행렬이 완성된다.

실무에서는 *행교환* 이 대부분 필요하다. 
행보다 열이 더 큰 행렬의 경우 행교환 연산 없이 행교체 연산만 수행하면 필연적으로 추축위치가 없는 열이 나온다. 반대로 행이 더 큰 행렬은 추축위치가 없는 행이 나온다. (추축위치 선정은 그 열에서 절대값으로 가장 큰 수를 택한다.) 여기서 행교환 연산 전에 추축열에서 추축위치 이하의 값들을 행렬L로 옮기고 추축위치의 값들로 각 열을 모두 나눈다. 그리고 나서 L에 행교환 연산을 수행하면 단위하삼각행렬이 만들어 진다. 

#+BEGIN_QUOTE
수치적 유의사항: 행 크기가 30이상이고 성분에 0이 적은 정방행렬의 연산횟수.
1. LU분해는 2n^3/3 flops, A^-1찾기는 2n^3 flops 소요된다.
2. Ly=b와 Ux=y는 2n^2 flops 소요된다. 삼각계 푸는데 n^2 flops가 소요되기 때문이다.
3. A^-1곱도 2n^2 flops가 소요된다. 하지만 계산결과가 LU분해만큼 정확하지는 않다.
4. 행렬자체가 0이 많으면, L과 U 행렬도 0이 많을 수 있다. 반면 A^-1는 0이 적을 가능성이 높다. 이런 때는 Ax=b 해를 구하는 것은 LU분해가 훨씬 더 빠르다. 
#+END_QUOTE

** 전기공학에서 나오는 행렬분해
전기회로와 행렬분해는 긴밀한 관계이다. 회로의 입출력을 전압 전류를 요소로 하는 벡터로 나타내보면 입력을 출력으로 변환하는 것은 대체로 선형이다. 이 변환에 있는 표준행렬을 전송행렬(transfer matrix)이라고 한다. 
전기회로를 설계하고 옴의 법칙과 키르히호프법칙을 이용해서 내부 회로의 개별 전송행렬을 구할 수 있다. 이것을 선형변환결합으로 하나의 행렬로 융합하면 해당 회로망의 전송행렬이 된다. 전송행렬은 전체 회로망의 출입을 개괄한다.

공학자가 착상한 회로를 만들기 전에 그것이 구현 가능한지를 판별해야 한다. 전송행렬을 확정한 뒤에 이것을 행렬분해하는데 최대한 기성회로부품들의 조합으로 구현 가능한지 판단하기 위해 기성회로들의 스펙에 맞춰 행렬분해를 시도한다. 


* 2.6 레온티프 입출력 모델
