** 3.3 크래머의 공식, 부피와 선형변환
*** 크래머 공식
Ax=b에서 b가 변할 때 해가 어떻게 영향을 받는지 연구하는데 사용된다.
A의 i번째 열을 b로 교체한 행렬을 Ai(b)라고 하자.
#+BEGIN_QUOTE
정리7. 크레머의 공식.\\
A는 가역적인 n 정방행렬이고 b는 Rn에 속할 때 Ax=b의 유일한 해 x의 원소는 다음의 식에 의하여 계산된다.
xi = detAi(b)/detA, i=1,2,...,n
#+END_QUOTE
Ai(b)는 AIi(x)와 같다. AIi(x) = A[e1 ... x ... en] = [Ae1 ... Ax ... Aen] = [a1 ... b ... an] = Ai(b) 가 된다.
AIi(x)를 행렬식으로 구해보면 detAIi(x) = detA*detIi(x)가 되는데 detIi(x)를 I의 i번째 행에 대하여 여인수 전개를 하면 x의 i번째 요소 xi가 된다.
주의할 것은 i번째는 1부터 n까지 이므로 x를 매번 해당 위치에 교체해 놓고 전개해야 한다. 즉 x의 모든 요소를 구하려면 n회의 Ii(x)를 구하고 그 각각에 대한 여인수전개를 해야 한다.
그러면 detA*xi = detAi(b) 인데 detA로 나누면 다시 xi = detAi(b)/detA가 된다.  

*** 공학에 응용
몇 가지 중요한 공학 문제들은 라플라스 변환으로 분석될 수 있다. 이것은 적절한 선형미분방정식계를 계수가 인자에 관계되는 선형방정식계(계수방정식)로 변환한다. 
라플라스 변환으로 발생되는 계수방정식은 계수 자체에 또다른 인자가 들어 있는 형태일 수 있다. 이를테면 s가 그 인자라고 하자. 그러면 계수행렬에서 미지수 s가 등장한다.
계수방정식이 유일한 해를 갖도록 s를 구해야 한다면 크레머 공식을 이용해서 x의 각요소에 대한 식을 s에 관하여 정리할 수 있다. 

*** A-1 공식
크레머 공식은 n정방행렬의 역행렬을 구하는 일반공식을 이끌어 낼 수 있다. AA-1=I이고 A*(A-1의 j열)은 같은 크기의 단위행렬의 j번째열이 된다.
ej가 단위행렬의 j번째 열이고, x의 요소들이 역행렬A-1의 i,j번째 요소일 때 x는 Ax=ej를 만족하는 A-1의 j번째 열이다.
i,j번째 요소 x = xi = detAi(ej)/detA

Aji는 A에서 j행과 i열을 제거한 부분을 모은 부분행렬이고, Ai(ej)는 A의 i열을 단위행렬의 j열 ej로 교체한 행렬임을 상기하자.
x의 요소들은 A-1의 i행,j열 요소들이다. 이 i,j가 A에 대하여는 j행 i열로 다르게 적용됨을 유의하자. 
detAi(ej)을 i열에 관해 여인수전개하면 detAi(ej) = (-1)^(i+j)*detAji + (나머지는 모두 0) = Cji 이다.
그러므로 A-1 = 1/detA*[[C11 C21 C31 ... Cn1] [C12 C22 C32 ... Cn2] ... [Cn1 Cn2 Cn3 ... Cnn]] 가 된다. 이처럼 여인수를 요소로 하는 행렬을 A의 *수반행렬(adjugate or adjoint)* 라고 하고 adjA로 표기한다.

#+BEGIN_QUOTE
정리8. 역행렬 공식.\\
A-1 = 1/detA*adjA
#+END_QUOTE
역행렬 공식을 응용해보면 A-1*A = 1/detA*adjA*A 이고 I = 1/detA*adjA*A가 되며
detA*I = adjA*A가 된다. 즉 adjA를 구하여 A와 곱하면 detA*I가 나오므로 detA를 구할 수 있다. 

#+BEGIN_QUOTE
수치적 유의사항.\\
역행렬을 구하는 것은 특수한 경우를 제외하고는 위의 역행렬 공식보다 [A I] 행축약이 더 낫다.
3x3복소수 행렬은 행축약보다 행렬식을 쓰는 크레머 공식이 더 낫다. 하지만 그보다 훨씬 큰 실수나 복소수 행렬에는 행축약만큼 오래걸린다. 
#+END_QUOTE

*** 면적 또는 부피로써의 행렬식
#+BEGIN_QUOTE
정리 9. 면적으로서의 행렬식, 부피로서의 행렬식\\
2x2 행렬A에서 A의 열들에 의해 결정되는 평행사변형 넓이는 |detA|, detA의 절대값.
3x3 행렬A에서 A의 열들에 의해 결정되는 평행육면체의 부피는 |detA|, detA의 절대값.
#+END_QUOTE

어떤 2x2 행렬도 그와 관련된 평행사변의 면적이나 행렬식의 값을 변하지 않는 방식으로 대각행렬로 변환시킬 수 있다. 열연산이 수행되어도 행렬식의 절대값은 변하지 않음을 이미 3.2에서 보았다.
이런 특성 덕분에 R2, R3의 벡터들에 적용되는 다음의 기하학적 관찰이 입증된다.

#+BEGIN_QUOTE
a1, a2는 0이 아닌 벡터다. 그러면 임의의 배수c에 대하여, a1, a2로 결정되는 평행사변형의 면적은 a1, a2+ca1에 의해 결정되는 평행사변형의 면적과 같다.
#+END_QUOTE 
이걸 입증하려면 일단 a1과 a2가 배수관계는 아니어야 한다. 배수관계면 위의 두 평행사변형은 결국 면적이 0이 되게 될 것이다. 
0과 a1을 지나는 직선 L이 있고 이와 평행하게 a2만큼 떨어진 직선 L+a2가 있어서 a1,a2가 0과 함께 오른쪽으로 기울어진 평행사변형을 이룬다고 해보자. 
c가 음수배이면 ca1은 왼쪽에 놓인 값인데 a2+ca1이 결과적으로 a1에 직교(perpendicular)하는 값이면서 L+a2 위에 있다면 
두개의 평행사변형은 0에서 a1까지를 공유하고 a2와 a2+ca1의 수직거리도 동일하기 때문에 면적이 같다. 

R3의 경우도 3x3행렬을 대각행렬로 바꾸는 열연산이 행렬식의 절대값에 영향을 미치지 않는다. 기울어진 평행육면체와 기울어지지 않은 평행육면체를 비교하면 면적이 동일함을 알 수 있다.
a1,a2,a3 열을 가진 행렬이 나타내는 평행육면체의 면적은 span{a1,a3}에 높이 a2를 곱한 것이다. 이것의 평행인 두 면이 위의 2차원 평행사변형처럼 오른쪽으로 기울어져 있다면 
똑바로 서있는 것을 a1, a2+ca1, c3 열을 가진 행렬이 나타내는 평행육면체라고 가정할 수 있다. 
후자의 면적은 span{a1,a3}에 높이 a2+ca1을 곱한 것인데 높이 a2+ca1이 a2와 마찬가지로 a2+span{a1,a3}에 위치해 있기 때문에 동일한 면적을 갖는다.

이런 특징을 이용하면 0점을 벗어난 위치에 있는 평행사변형을 0점 위치로 이동시켜 놓고 대각행렬로 바꾼 뒤에 행렬식을 구함으로써 그 면적을 쉽게 구할 수 있게 된다.

*** 선형변환
행렬식을 R3에 있는 평면의 기하학적 특성을 설명하는데 사용할 수도 있다. S가 도메인, T가 선형변환, T(S)가 S의 상의 집합이라고 하자. 
S와 T(S)가 기하학적인 면적이나 부피를 가질 수 있다. 편의상 그 영역이 둘러싸인 형태에 따라 평행사변형이나 평행육면체라고 부르기로 하자.
#+BEGIN_QUOTE
정리 10. 정의역과 치역의 행렬식을 이용한 함수관계\\
T:R2->R2가 2x2행렬A에 의해 결정되는 선형변환일 때, S가 평행사변형이면 \\ 
{T(S)면적} = |detA|{S면적}.
T가 3x3행렬A에 의해 결정되고 S가 R3의 평행육면체면 \\
{T(S)부피} = |detA|{S부피}  
#+END_QUOTE
A는 변환T이고 B가 정의역S을 나타내는 행렬이라고 하면 AB가 변환된 결과 T(S)가 된다.
결국 {T(S)면적 또는 부피} = |detAB| = |detA||detB| = |detA|{S면적 또는 부피} 가 된다.
유의할 것은 B의 열로 나타내는 S는 {s1b1 + s2b2}인데 s1,s2 모두 0과 1 사이의 값일 것을 요구한다.

평행이동된 S의 면적을 구하는 경우에 평행이동은 면적에 아무런 영향도 주지 않는다.
그래서 {T(p+S)면적} = {T(p)+T(S) 면적} = {T(S)면적} = |detA|{S면적} = |detA|{p+S면적} 이 된다.

정리10을 직선이 아닌 영역에 적용할 때 그 영역을 어떻게 정의하고 면적이나 부피를 어떻게 계산할지 문제에 봉착한다.
R2에 평면 영역이 있으면 R2에 놓인 정사각 격자를 이용하여 영역을 어림잡을 수 있는데, 격자가 촘촘할 수록 실제 크기에 가까워진다.
이 영역에 변화를 가하면 정사각 격자들에 그 변화가 반영이 되어 격자가 평행사변형으로 변한다. 그러면 영역 내부의 평행사변형 격자를 모아서 변화된 영역을 역시 어림잡을 수 있다.
이 격자의 변화는 여전히 정리 10이 유효하게 적용된다.

R2, R3에서 유한한 면적과 부피에는 언제나 정리10이 유효하다. 정리10은 일단 A와 정의역을 알면 A의 행렬식과 정의역을 영역을 구하여 치역을 구하는 방법이다.

방정식이 x1^2/a^2 + x2^2/b^2 = 1 인 타원형 영역의 면적은 어떻게 구할까?
먼저 타원형의 면적에 대한 방정식을 이해할 필요가 있다. a,b는 각각 x1축과 x2축에 있는 값으로 타원형의 둘레가 지나가는 위치가 된다. x1,x2는 타원형 내부의 모든 좌표가 된다. 
이제 반지름이 1인 원형 면적 D가 변형되어 가로반지름 a 세로반지름 b인 타원형 면적 E가 된다고 가정해보자. 
이것은 정리10의 변화의 행렬식과 정의역의 영역크기를 이용하여 치역의 영역을 구하는 공식을 이용하기 위한 설정이다.
D의 [[1 0] [0 1]]이 변형되어 E의 [[a 0] [0 b]]로 되는 것이므로 변환A는 [[a 0] [0 b]]가 된다. 
정의역인 D의 좌표가 U = (u1,u2)라고 하고 치역 E의 좌표가 x = (x1,x2)이고 x = AU라고 하자.
그러면 x = AU에 따라서 u1 = x1/a , u2 = x2/b 의 관계를 가진다.
정의역의 면적은 u1^2/1^2 + u2^2/1^2 <= 1 이고 u1,u2를 치환하면 (x1/a)^2 + (x2/b)^2 <= 1 이 된다.
그런데 재밌는 것은 치환된 식은 바로 면적 E의 공식이기도 하다. 즉 x1/a, x2/b가 면적D에 있어야 x1,x2 쌍이 면적E에 있을 수 있고
반대로 x1,x2 쌍이 면적E에 있어야 x1/a, x2/b 쌍이 면적D에 있을 수 있다.
정리10을 적용해 보면 T(D)면적 = |detA|*D면적 = ab*π(1)^2 이 된다. D는 반지름 1인 원인데, 원면적은 πr^2이므로 그렇다.
 

* 4. 벡터 공간(Vector Spaces)
** 4.1 벡터 공간과 부분공간
#+BEGIN_QUOTE
정의. 벡터공간과 그곳에 적용되는 10가지 특성들.\\
벡터공간은 벡터라 불리우는 객체들의 비어있지 않는 집합 V이다. 벡터에는 두가지 연산이 정의되어 있는데 더하기와 실수배가 그것이다.(행렬곱은 있어도 벡터곱은 없다.) 또한 벡터는 아래에 나열된 10가지 규칙의 지배를 받는다. 이 규칙은 V에 있는 모든 벡터 u,v,w와 모든 상수 c,d에도 유지된다.

1. u와 v의 합은 u + v로 표기되며 V에 존재한다.
2. u + v = v + u. 즉 순서를 바꾸어 더하여도 동일하다.
3. (u + v) + w = u + (v + w). 즉 연속된 더하기도 순서를 바꾸어도 동일하다.
4. u + 0 = u 가 되는 0벡터가 V에 존재한다.
5. V에 있는 각각의 u에 대하여 u + (-u) = 0 이 되는 벡터 -u가 V에 존재한다.
6. u의 c상수배는 cu로 표기하며 V에 존재한다.
7. c(u + v) = cu + cv. 즉 상수배는 분배될 수 있다.
8. (c + d)u = cu + du. 즉 상수의 합에 대한 벡터의 분배도 가능하다.
9. c(du) = (cd)u. 즉 상수배와 벡터 사이에도 결합법칙이 적용된다.
10. 1u = u. 즉 벡터도 상수1과 곱하면 자기 자신이 된다.   
#+END_QUOTE
위 규칙은 실수벡터공간 외에 복소수벡터공간에도 적용된다.

#+BEGIN_QUOTE
벡터공간 V에 있는 u와 상수 c에 대하여\\
0u = 0\\
c0 = 0\\
-u = (-1)u
#+END_QUOTE 
3차원 공간의 모든 화살표의 집합도 벡터공간이다.

*이중무한실수열* 은 수열이 전과 후 양쪽으로 무한하게 전개되는 것을 의미하는 것으로 추정된다. 이 이중무한실수열 공간도 벡터공간이다.
이중무한실수열 공간의 요소들은 공학에서 신호를 이산 시간에 측정하면 드러난다. 이런 점에서 편의상 이중무한실수열 공간을 이산시간신호 공간으로 부르자.

*다항식(polynomial)* 은 변수와 상수(변수에 붙는 계수)의 합,차,곱으로 이루어진 식이다.
최대 n차 다항식들의 집합 P^{n}은 p(t) = a_{0} + a_{1}t + a_{2}t^{2} + ... + a_{n}t^{n} 형태의 모든 다항식으로 구성된다. 이 때 계수와 변수는 모두 실수다.
p의 차수는 계수가 0이 아닌 항중 최고의 거듭제곱수가 된다. p(t) = a_{1} 이고 0이 아니면 p의 차수는 0이 된다. 만약 모든 계수가 0이라면 p는 *0다항식* 이라고 불린다.
0다항식은 차수가 정의되지 않더라도 P^{n}에 포함된다. 이들 다항식에도 합과 실수배가 정의된다. 그러므로 차수n이 0이상인 다항식에 벡터공간 공리 1,6이 만족된다.
공리 2,3,7,8,9,10은 실수의 성질로부터 나오고 0다항식이 공리4의 0벡터이며 -1p가 덧셈의 항등원을 이끌어 내는 -p로 작용하므로 공리5도 충족된다. 
모든 공리가 만족되므로 다항식 P^{n}도 벡터공간이다.

*실가함수(real-valued function)* 는 치역이 실수인 함수이다.
실수 집합 또는 실수의 일부 구간인 D에 정의된 모든 실가함수들의 집합 V가 있다면 그 원소들인 실가함수들의 합과 실수배가 가능하며 다른 벡터공간의 공리도 실수의 성질로부터 유도된다.
따라서 실가함수의 집합도 벡터공간이다. 각 함수를 벡터 공간의 점 내지는 벡터로 생각하는 것이 중요하다.  

*** 부분공간
많은 경우에 벡터 공간은 보다 큰 벡터 공간의 벡터들의 부분집합으로 구성된다. 이럴 경우에는 벡터공간 공리 10개 중에 3개만 만족되면 나머지 7개는 자동으로 충족된다.

#+BEGIN_QUOTE
벡터공간 V의 부분집합은 다음 3가지 특성을 갖는 V의 부분공간 H이다.
a. V의 0벡터는 H^{2}에 있다. (벡터공간의 공리4)\\
b. H는 벡터합에 닫혀 있다. 즉 H의 u,v에 대하여 u+v도 H에 속한다. (벡터공간의 공리1)\\ 
c. H는 실수배에 닫혀 있다. 즉 H의 u와 상수 c에 대하여 cu도 H에 속한다. (벡터공간의 공리6)
#+END_QUOTE
공리 2,3,7,8,9,10은 이미 상위 벡터공간의 원소들에 적용되는데 여기에 부분공간의 원소들도 포함되므로 당연히 적용된다.
공리5는 c의 상수가 -1인 경우에 해당하므로 역시 적용된다.
모든 부분공간은 벡터공간이고 역으로 모든 벡터공간도 부분공간이다. 부분공간이란 용어는 최소 두개의 벡터공간이 있고 하나가 다른 하나에 포함될 때 사용된다.
V의 부분공간이라는 표현은 V를 더 큰 공간으로 식별한다.

0벡터만으로 구성되는 집합도 부분공간이며 특별히 *0부분공간* 으로 부른다. {0}로 표기한다. 

모든 다항식의 집합 P가 실수인 계수와 함수에 대한 연산처럼 정의된 연산이 있다고 하자. 그러면 P는 R에 정의된 모든 실가함수들의 공간의 부분공간이다.
또한 n이 0이상일 때 P^{n}은 P의 부분공간인데 왜냐하면 P^{n}이 0다항식을 포함하는 P의 부분집합이며, P^{n}에 있는 두 다항식의 합 또한 P^{n}에 있고,
P^{n}의 다항식의 실수배 또한 P^{n}에 있기 때문이다. 

벡터공간 R^{2}는 R^{3}의 부분공간이 아니다. 왜냐하면 R^{2}는 R^{3}의 부분집합도 아니기 때문이다.
집합 H = {열벡터[s t 0]:s,t는 실수}는 R^{2}처럼 보이고 작동하는 R^{3}의 부분집합이다. 이 H가 R^{3}의 부분공간일까?
0벡터가 H에 들어있고, 덧샘과 실수배는 H에 닫혀있다. 왜냐하면 H의 벡터에 대한 덧샘과 실수배는 항상 3번째요소가 0인 벡터를 만들기 때문이다.
그러므로 H는 R^{3}의 부분공간이 맞다.  

0점을 지나지 않는 평면이나 선분은 부분공간이 될 수 없다.

*** 집합에 의해 생성되는 부분공간
선형결합은 벡터들의 실수배의 임의의 합이고 Span{v_{1},...,v_{p}}은 v_{1},...,v_{p}의 선형결합으로 작성될 수 있는 모든 집합이다.

벡터공간V의 벡터v_{1},v_{2}가 있을 때 집합 H=Span{v_{1},v_{2}}가 V의 부분공간이 되려면 H 안에 0벡터가 있고, 합과 실수배에 닫혀 있으면 된다.
H의 선형결합에는 0 = 0v_{1} + 0v_{2}이 존재한다. 따라서 0벡터가 있다.
합에 닫혀있는지는 H에 속하는 임의의 벡터u,v가 있을 때 u+v가 다시 H에 속하는지 알면 되는데 이것을 확인하는 방법은 u,v 역시 H의 선형결합으로 나타내어 u+v도 결국 H의 선형결합이 되는지 확인하는 것이다. 된다.
실수배에 닫혀있는지도 임의의 벡터u가 H의 선형결합으로 표현된 상태에서 실수배 cu가 H의 선형결합이 되는지 확인하면 된다. 결론은 닫혀있다.

R^{3}에서 자신을 제외한 0이 아닌 부분공간은 선형독립인 v_{1},v_{2}에 대하여 Span{v_{1},v_{2}}이거나 0이 아닌 v에 대하여 Span{v}이거나 둘 중 하나이다. 

#+BEGIN_QUOTE
정리 1. v_{1},...,v_{p}가 벡터공간V에 있으면 Span{v_{1},...,v_{n}}은 V의 부분공간이다. 
#+END_QUOTE
Span{v_{1},...,v_{p}}을 *생성되는 부분공간* 이라고 부르고 집합{v_{1},...,v_{p}}을 H를 *생성하는 집합(생성집합)* 이라고 부른다.

집합 H = {(a-3b,b-a,a,b): a,b는 실수} 이면 H가 R^{4}의 부분공간일까? 
매개변수a,b에 대한 벡터방정식으로 변형함으로써 선형결합으로 나타낼 수 있다. 이 벡터들은 4개 요소를 가지므로 모두 R^{4}의 요소들이므로
정리1에 따라 이 벡터집합으로 생성된 공간은 R^{4}의 부분공간이 된다. 

생성집합을 부분공간을 유지시켜주는 조종간으로 생각해 볼 수 있다. 부분공간의 무수히 많은 벡터에 대한 계산은 생성집합의 유한한 개수의 벡터연산으로 축소된다.

** 4.2 영공간, 열공간, 선형변환
