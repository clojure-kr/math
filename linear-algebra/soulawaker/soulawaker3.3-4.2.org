** 3.3 크래머의 공식, 부피와 선형변환
*** 크래머 공식
Ax=b에서 b가 변할 때 해가 어떻게 영향을 받는지 연구하는데 사용된다.
A의 i번째 열을 b로 교체한 행렬을 Ai(b)라고 하자.
#+BEGIN_QUOTE
정리7. 크레머의 공식.

A는 가역적인 n 정방행렬이고 b는 Rn에 속할 때 Ax=b의 유일한 해 x의 원소는 다음의 식에 의하여 계산된다.
xi = detAi(b)/detA, i=1,2,...,n
#+END_QUOTE
Ai(b)는 AIi(x)와 같다. AIi(x) = A[e1 ... x ... en] = [Ae1 ... Ax ... Aen] = [a1 ... b ... an] = Ai(b) 가 된다.
AIi(x)를 행렬식으로 구해보면 detAIi(x) = detA*detIi(x)가 되는데 detIi(x)를 I의 i번째 행에 대하여 여인수 전개를 하면 x의 i번째 요소 xi가 된다.
주의할 것은 i번째는 1부터 n까지 이므로 x를 매번 해당 위치에 교체해 놓고 전개해야 한다. 즉 x의 모든 요소를 구하려면 n회의 Ii(x)를 구하고 그 각각에 대한 여인수전개를 해야 한다.
그러면 detA*xi = detAi(b) 인데 detA로 나누면 다시 xi = detAi(b)/detA가 된다.  

*** 공학에 응용
몇 가지 중요한 공학 문제들은 라플라스 변환으로 분석될 수 있다. 이것은 적절한 선형미분방정식계를 계수가 인자에 관계되는 선형방정식계(계수방정식)로 변환한다. 
라플라스 변환으로 발생되는 계수방정식은 계수 자체에 또다른 인자가 들어 있는 형태일 수 있다. 이를테면 s가 그 인자라고 하자. 그러면 계수행렬에서 미지수 s가 등장한다.
계수방정식이 유일한 해를 갖도록 s를 구해야 한다면 크레머 공식을 이용해서 x의 각요소에 대한 식을 s에 관하여 정리할 수 있다. 

*** A-1 공식
크레머 공식은 n정방행렬의 역행렬을 구하는 일반공식을 이끌어 낼 수 있다. AA-1=I이고 A*(A-1의 j열)은 같은 크기의 단위행렬의 j번째열이 된다.
ej가 단위행렬의 j번째 열이고, x의 요소들이 역행렬A-1의 i,j번째 요소일 때 x는 Ax=ej를 만족하는 A-1의 j번째 열이다.
i,j번째 요소 x = xi = detAi(ej)/detA

Aji는 A에서 j행과 i열을 제거한 부분을 모은 부분행렬이고, Ai(ej)는 A의 i열을 단위행렬의 j열 ej로 교체한 행렬임을 상기하자.
x의 요소들은 A-1의 i행,j열 요소들이다. 이 i,j가 A에 대하여는 j행 i열로 다르게 적용됨을 유의하자. 
detAi(ej)을 i열에 관해 여인수전개하면 detAi(ej) = (-1)^(i+j)*detAji + (나머지는 모두 0) = Cji 이다.
그러므로 A-1 = 1/detA*[[C11 C21 C31 ... Cn1] [C12 C22 C32 ... Cn2] ... [Cn1 Cn2 Cn3 ... Cnn]] 가 된다. 이처럼 여인수를 요소로 하는 행렬을 A의 *수반행렬(adjugate or adjoint)* 라고 하고 adjA로 표기한다.

#+BEGIN_QUOTE
정리8. 역행렬 공식.

A-1 = 1/detA*adjA
#+END_QUOTE
역행렬 공식을 응용해보면 A-1*A = 1/detA*adjA*A 이고 I = 1/detA*adjA*A가 되며
detA*I = adjA*A가 된다. 즉 adjA를 구하여 A와 곱하면 detA*I가 나오므로 detA를 구할 수 있다. 

#+BEGIN_QUOTE
수치적 유의사항.

역행렬을 구하는 것은 특수한 경우를 제외하고는 위의 역행렬 공식보다 [A I] 행축약이 더 낫다.
3x3복소수 행렬은 행축약보다 행렬식을 쓰는 크레머 공식이 더 낫다. 하지만 그보다 훨씬 큰 실수나 복소수 행렬에는 행축약만큼 오래걸린다. 
#+END_QUOTE

*** 면적 또는 부피로써의 행렬식
#+BEGIN_QUOTE
정리 9. 면적으로서의 행렬식, 부피로서의 행렬식

2x2 행렬A에서 A의 열들에 의해 결정되는 평행사변형 넓이는 |detA|, detA의 절대값.
3x3 행렬A에서 A의 열들에 의해 결정되는 평행육면체의 부피는 |detA|, detA의 절대값.
#+END_QUOTE

어떤 2x2 행렬도 그와 관련된 평행사변의 면적이나 행렬식의 값을 변하지 않는 방식으로 대각행렬로 변환시킬 수 있다. 열연산이 수행되어도 행렬식의 절대값은 변하지 않음을 이미 3.2에서 보았다.
이런 특성 덕분에 R2, R3의 벡터들에 적용되는 다음의 기하학적 관찰이 입증된다.

#+BEGIN_QUOTE
a1, a2는 0이 아닌 벡터다. 그러면 임의의 배수c에 대하여, a1, a2로 결정되는 평행사변형의 면적은 a1, a2+ca1에 의해 결정되는 평행사변형의 면적과 같다.
#+END_QUOTE 
이걸 입증하려면 일단 a1과 a2가 배수관계는 아니어야 한다. 배수관계면 위의 두 평행사변형은 결국 면적이 0이 되게 될 것이다. 
0과 a1을 지나는 직선 L이 있고 이와 평행하게 a2만큼 떨어진 직선 L+a2가 있어서 a1,a2가 0과 함께 오른쪽으로 기울어진 평행사변형을 이룬다고 해보자. 
c가 음수배이면 ca1은 왼쪽에 놓인 값인데 a2+ca1이 결과적으로 a1에 직교(perpendicular)하는 값이면서 L+a2 위에 있다면 
두개의 평행사변형은 0에서 a1까지를 공유하고 a2와 a2+ca1의 수직거리도 동일하기 때문에 면적이 같다. 

R3의 경우도 3x3행렬을 대각행렬로 바꾸는 열연산이 행렬식의 절대값에 영향을 미치지 않는다. 기울어진 평행육면체와 기울어지지 않은 평행육면체를 비교하면 면적이 동일함을 알 수 있다.
a1,a2,a3 열을 가진 행렬이 나타내는 평행육면체의 면적은 span{a1,a3}에 높이 a2를 곱한 것이다. 이것의 평행인 두 면이 위의 2차원 평행사변형처럼 오른쪽으로 기울어져 있다면 
똑바로 서있는 것을 a1, a2+ca1, c3 열을 가진 행렬이 나타내는 평행육면체라고 가정할 수 있다. 
후자의 면적은 span{a1,a3}에 높이 a2+ca1을 곱한 것인데 높이 a2+ca1이 a2와 마찬가지로 a2+span{a1,a3}에 위치해 있기 때문에 동일한 면적을 갖는다.

이런 특징을 이용하면 0점을 벗어난 위치에 있는 평행사변형을 0점 위치로 이동시켜 놓고 대각행렬로 바꾼 뒤에 행렬식을 구함으로써 그 면적을 쉽게 구할 수 있게 된다.

*** 선형변환
행렬식을 R3에 있는 평면의 기하학적 특성을 설명하는데 사용할 수도 있다. S가 도메인, T가 선형변환, T(S)가 S의 상의 집합이라고 하자. 
S와 T(S)가 기하학적인 면적이나 부피를 가질 수 있다. 편의상 그 영역이 둘러싸인 형태에 따라 평행사변형이나 평행육면체라고 부르기로 하자.
#+BEGIN_QUOTE
정리 10. 정의역과 치역의 행렬식을 이용한 함수관계\\
T:R2->R2가 2x2행렬A에 의해 결정되는 선형변환일 때, S가 평행사변형이면 \\ 
{T(S)면적} = |detA|{S면적}.
T가 3x3행렬A에 의해 결정되고 S가 R3의 평행육면체면 \\
{T(S)부피} = |detA|{S부피}  
#+END_QUOTE
A는 변환T이고 B가 정의역S을 나타내는 행렬이라고 하면 AB가 변환된 결과 T(S)가 된다.
결국 {T(S)면적 또는 부피} = |detAB| = |detA||detB| = |detA|{S면적 또는 부피} 가 된다.
유의할 것은 B의 열로 나타내는 S는 {s1b1 + s2b2}인데 s1,s2 모두 0과 1 사이의 값일 것을 요구한다.

평행이동된 S의 면적을 구하는 경우에 평행이동은 면적에 아무런 영향도 주지 않는다.
그래서 {T(p+S)면적} = {T(p)+T(S) 면적} = {T(S)면적} = |detA|{S면적} = |detA|{p+S면적} 이 된다.

정리10을 직선이 아닌 영역에 적용할 때 그 영역을 어떻게 정의하고 면적이나 부피를 어떻게 계산할지 문제에 봉착한다.
R2에 평면 영역이 있으면 R2에 놓인 정사각 격자를 이용하여 영역을 어림잡을 수 있는데, 격자가 촘촘할 수록 실제 크기에 가까워진다.
이 영역에 변화를 가하면 정사각 격자들에 그 변화가 반영이 되어 격자가 평행사변형으로 변한다. 그러면 영역 내부의 평행사변형 격자를 모아서 변화된 영역을 역시 어림잡을 수 있다.
이 격자의 변화는 여전히 정리 10이 유효하게 적용된다.

R2, R3에서 유한한 면적과 부피에는 언제나 정리10이 유효하다. 정리10은 일단 A와 정의역을 알면 A의 행렬식과 정의역을 영역을 구하여 치역을 구하는 방법이다.

방정식이 x1^2/a^2 + x2^2/b^2 = 1 인 타원형 영역의 면적은 어떻게 구할까?
먼저 타원형의 면적에 대한 방정식을 이해할 필요가 있다. a,b는 각각 x1축과 x2축에 있는 값으로 타원형의 둘레가 지나가는 위치가 된다. x1,x2는 타원형 내부의 모든 좌표가 된다. 
이제 반지름이 1인 원형 면적 D가 변형되어 가로반지름 a 세로반지름 b인 타원형 면적 E가 된다고 가정해보자. 
이것은 정리10의 변화의 행렬식과 정의역의 영역크기를 이용하여 치역의 영역을 구하는 공식을 이용하기 위한 설정이다.
D의 [[1 0] [0 1]]이 변형되어 E의 [[a 0] [0 b]]로 되는 것이므로 변환A는 [[a 0] [0 b]]가 된다. 
정의역인 D의 좌표가 U = (u1,u2)라고 하고 치역 E의 좌표가 x = (x1,x2)이고 x = AU라고 하자.
그러면 x = AU에 따라서 u1 = x1/a , u2 = x2/b 의 관계를 가진다.
정의역의 면적은 u1^2/1^2 + u2^2/1^2 <= 1 이고 u1,u2를 치환하면 (x1/a)^2 + (x2/b)^2 <= 1 이 된다.
그런데 재밌는 것은 치환된 식은 바로 면적 E의 공식이기도 하다. 즉 x1/a, x2/b가 면적D에 있어야 x1,x2 쌍이 면적E에 있을 수 있고
반대로 x1,x2 쌍이 면적E에 있어야 x1/a, x2/b 쌍이 면적D에 있을 수 있다.
정리10을 적용해 보면 T(D)면적 = |detA|*D면적 = ab*π(1)^2 이 된다. D는 반지름 1인 원인데, 원면적은 πr^2이므로 그렇다.
 

* 4. 벡터 공간(Vector Spaces)
** 4.1 벡터 공간과 부분공간

** 4.2 영공간, 열공간, 선형변환
