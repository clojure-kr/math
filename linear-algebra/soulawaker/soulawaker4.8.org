** 4.8 차분방정식으로 응용(Applications to Difference Equations)
   차분방정식은 이산데이터 분석에 적합한 방법이다. 미분방정식은 연속데이터 분석에 적합하다.
*** 이산신호
    이산신호들이 모인 공간 역시 벡터공간이다. 4.1절에서 보았다. 이산신호의 벡터공간을 신호공간이라고 한다.
    신호공간에서 신호는 곧 수열이다.
    예를들어 CD음질은 본래의 연속적인 음악신호를 1초에 44,100회씩 끊어서 추출한 데이터로 만든다.
    여기에는 사람이 파악하지 못하는 주파수 정보도 들어 있다.
*** 신호공간S에서의 일차독립
    3개의 신호가 있을 때 특정시점에서 추출한 3개의 신호와 3개의 상수로 값이 0이 되는 선형방정식을 만들 수 있다.
    그러면 3개의 상수가 모두 0일 때 이 방정식은 선형독립이 된다.
    그 시점이후로 순차적으로 발생된 몇개의 신호에 대한 방정식도 만들 수 있다. 편의상 2개만 더 구성해 보자.
    그렇게 3개의 선형방정식으로 구성된 선형방정식계를 행렬방정식으로 바꿀 수 있다.
    그러면 3개의 신호에 대한 수열을 열로 하는 행렬과 상수벡터의 곱이 영벡터인 행렬방정식이 된다.
    여기서 신호의 수열로 구성된 계수행렬을 *Casorati행렬* 이라고 한다.
    그리고 Casorati행렬의 행렬식을 이산신호(수열)들의 *Casoratian* 이라고 한다.

    Casorati행렬을 행축약해서 사다리꼴로 만들어보면 신호들이 선형독립인지 아닌지 알 수 있게 된다.
    즉 이산신호의 선형독립 여부를 검사하는데 사용하는 행렬이 바로 Casorati행렬이다.
    행축약을 해서 상삼각행렬이 나오면 가역행렬이므로 선형독립임이 분명하다.

    하지만 특정지점의 신호를 추출해서 검사했는데 상삼각행렬이 나오지 않을 수도 있다.
    그렇다고 바로 신호 전체가 일차독립이 아니라고 단정할 수는 없다.
    이럴떄는 동차차분방정식(선형동차차분방정식)을 이용하여 일차종속 여부를 결정할 수 있다.
    위의 신호들이 모두 동일한 동차차분방정식에서 해가 되는지 확인해 보면 된다.
    만약 3개 신호 모두 하나의 방정식의 해가 된다면 각 신호들 전체가 선형종속임이 분명해진다.

*** 선형차분방정식(linear difference equation)
    다른 선형방정식과 마찬가지로 상수와 미지수의 곱으로 된 항들의 합이 연이어진 것이 특정값과 같아지는 형태이다.
    하지만 특이하게도 상수는 순차적으로 배치되는데 미지수는 역순으로 배치된다.
    미지수는 계속되는 신호의 정해진 시작과 끝이 없이 나타내기 위하여 미지수에 k를 붙여 표시한다.
    즉 선형차분방정식은 무수히 반복될 수 있는 점화식인 것이다.
    즉 최초의 상수와 마지막 미지수의 곱부터 시작해서 마지막 상수와 최초의 미지수의 곱을 더하는 것으로 끝난다.
    또 특이한 것은 최초의 상수와 마지막 상수가 반드시 0이 아니어야 한다는 제약조건이 있다는 것이다.
    
    여기서 미지수들은 하나의 입력신호의 이산값들을 나타내고
    상수들이 입력신호를 출력신호로 바꿔주는 필터역할을 맡게 된다. 이것을 필터계수라고 부른다.
    그리고 출력신호가 영수열이면 동차선형차분방정식이라고 부르고 영수열이 아니면 비동차선형차분방정식이라고 부른다.

    선형차분방정식이 필터역할을 하므로 다른 주파수의 입력신호들을 따로 넣어보면 어떤 경우는 0이 될 수도 있고
    어떤 경우는 신호가 살짝 뒤로 밀리긴 하지만 전체적으로 신호가 누락되지 않고 모두 출력되는 결과를 얻을 수도 있다.
    
    신호가 등비수열로 주어질 경우 차분방정식은 고차방정식 형태가 되는데
    이때 수열의 일반항(k가 붙은 항)을 우선 뽑아 낸 나머지 방정식을 구할 수 있다. 
    이것이 보조방정식이다. 이 보조방정식을 인수분해하여 그에 대한 근이 모두 구해지면
    입력신호의 전체가 차분방정식의 해가 된다고 인정할 수 있다.

*** 선형차분방정식의 해의 집합
    #+BEGIN_QUOTE
    정리16. 선형차분방정식이 유일한 해를 갖는 경우\\
    0부터 n까지의 상수 중 마지막 상수가 0이 아닌 때 차분방정식은
    입력신호가 0부터 n-1까지는 주어졌다면 유일한 해를 갖는다.
    #+END_QUOTE
    n번째 신호(y_{n})가 유일한 것이 증명이 되면 된다.
    n번째 신호는 차분방정식에 주어진 입력신호를 집어 넣으면 구할 수 있다.
    n번째 신호는 상수곱도 없다. 나머지 항들은 모두 상수와 정해진 신호값의 곱이다. 따라서 n번째 신호는 유일하게 정해진다.
    n번째 신호에 관하여 차분방정식을 정리한 것을
    k가 0이상일 때 신호n+k 점화관계로 확장해보거나 
    k가 0미만일 때 신호k의 점화관계로 바꿔 볼 수 있다.
    정리16을 만족하는 신호는 정리로부터 유도된 위 두가지 점화관계도 반드시 만족한다.
    이렇게까지 전개되어서야 해가 유일하다고 선언할 수 있는 이유는 아직 명확하지 않다.
    이미 값이 n번쨰 신호만 빼고 다 정해졌기 때문에 유일하게 정해진다고 보는 것이 더 간단해 보인다.

    #+BEGIN_QUOTE
    정리17. n차 동차선형차분방정식의 모든 k에 대하여 해집합 H는 n차 벡터공간이다.
    #+END_QUOTE
    H는 영공간이므로 신호공간의 부분공간이다. 갑자기 선형변환 F가 등장하는데 이것과 동차선형차분방정식이 어떤 관계인가?
    만약에 차분방정식의 계수행렬이라고 한다면 출력신호가 영신호가 되어야 하는데 책에서는 R^{n}의 벡터라고 가정하고 있다.
    그리고 출력에 대한 유일한 입력신호가 있다고 하면서 일대일 선형변환이라고 말하므로 F는 동차방정식의 계수행렬이라 볼 수 없다.
    봐야 한다면 출력이 0신호 뿐이므로 일대일 선형변환일 수가 없기 때문이다.
    그러면 F를 갑자기 끌고 들어와 어떻게 연관을 지을 수 있는 것인지 더욱 명확하게 다가오지 않는다.

    동차차분방정식의 일반해를 나타내는 방법은 방정식을 만족하는 입력신호집합 공간(해공간)의 기저를 보여주는 것이다.
    이러한 기저를 *해의 기본집합* 이라고 한다.

*** 비동차(차분)방정식
    이것의 일반해는 동차차분방정식의 일반해에다가 비동차차분방정식의 특별해 하나를 더한 것이다.
    동차계, 비동차계 관계와 같다. 즉 신호의 변환도 선형변환인 것이다.

    예제6에서 입력신호가 k^2 일 경우 비동차차분방정식이 주어지는데 전체신호에 대하여 이 방정식이 만족하는지 보이라고 한다.
    즉 주어진 특수 입력신호가 비동차의 특별해가 되는지 먼저 확인하고 맞다면
    비동차로부터 동차식을 만들어서 그것의 해집합을 보조방정식을 도출하여 구해야 한다.
    이때 동차의 입력신호는 앞서 다뤘듯이 통상 y = r^{k} 라고 가정해서 보조방정식을 구할 수 있다.
    보조방정식을 인수분해하여 나온 해는 위 입력신호 식에 의하여 각 수의 k제곱이 된다.
    그것들이 상호간에 스칼라곱이 안된다면 일차독립 관계이므로 그것들의 선형결합을 해집합으로 제시할 수 있다.

*** 선형방정식계로의 환원
    동차차분방정식을 푸는 더 쉬운 방법은 동치인 선형방정식계로 바꾸어 푸는 것이다.
    신호는 점화관계를 유지하므로 선형방정식계 역시 점화관계로 표현이 가능하다.
    $$ X_{k+1} = AX_{k} $$
    X_{k}가 k부터 n까지의 연속된 신호를 담은 벡터라면
    X_{k+1}은 k+1부터 n+1까지의 연속된 신호를 담은 벡터다.
    동차차분방정식의 점화관계를 가장 뒤의 신호는 나머지 신호들의 결합에 마이너스를 가한 것과 같다.
    여기서 k+1번째 신호가 구해지므로 X_{k+1}을 매개벡터변수 형식으로 바꾸면 AX_{k} 형태로 변화된다.
    여기서 아주 특징적인 A의 형태를 발견하게 된다.
    A의 멘 마지막 행은 나머지 신호들의 결합에 마이너스가 붙은 것의 계수들이다.
    그리고 A의 첫번째 행부터 마지막 전까지 행은 두번째 열부터 대각선으로 내려가면서 1 하나만 배치되는 형태를 가진다.
 
 
