** 5.3 대각화(Diagonalization)
   행렬의 인수분해란 어떤 행렬을 가역행렬과 대각행렬 및 가역행렬의 역행렬의 곱으로 분해하는 것이다.
   어떤 행렬의 k승이 있고 k가 클 때 행렬의 인수분해를 사용하면 계산이 편해진다.
   대각행렬의 거듭제곱만 놓고 보면 그 요소인 대각성분들의 계속된 제곱이 된다.
   인수분해된 행렬들의 거듭제곱을 살펴보면 중간에 가역행렬과 그 역행렬이 만나서 단위행렬이 되므로 대각행렬들만 연이어 남게 된다.
   즉 대각행렬의 거듭제곱과 좌 우의 가역행렬 및 그것의 역행렬의 곱만 남는 것이다.
   그러므로 실제로 어떤 행렬을 연속으로 상당수 곱하는 것보다 인수분해를 이용하여 가역행렬과 대각행렬의 거듭제곱 및 가역행렬의 역행렬의 곱으로 변형하여 계산하는 것이 더 수월하다.
   이렇게 행렬의 인수분해가 가능한 행렬을 *대각화가능행렬* 이라고 한다.

   #+BEGIN_QUOTE
   정리5. 대각화 정리(행렬 인수분해의 방법)\\
   n정사각행렬이 대각화가능행렬이 되려면 반드시 n개의 선형독립인 고유벡터를 가져야 한다.(대각화의 필요충분조건) 
   인수분해된 가역행렬, 대각행렬, 역행렬의 곱들에서 가역행렬의 열들이 원본행렬의 선형독립인 n개의 고유벡터들이어야 한다.
   그리고 대각행렬의 성분들은 차례대로 그 고유벡터들에 대응되는 고유값들이다.
   #+END_QUOTE
   n정방행렬의 고유벡터들이 R^{n}의 기저가 된다면 그 정방행렬은 대각화 가능한 것이다.
   이 때 위 고유벡터들을 *고유벡터기저* 라고 한다. 즉 고유벡터 중에서 기저도 되는 것을 가리킨다.
   (그런데 R^{n} 은 무엇에 대한 공간인 것인가? 입력공간인가? 일단 고유벡터가 모두 입력벡터라는 점에서는 가능하다.)
   정리5 증명방법: n정방행렬A와 v_{1},...,v_{n} 벡터로 된 가역행렬P의 곱 AP를 생각해 본다. 그리고 그 가역행렬P와 \lambda_{1},...,\lambda_{n} 까지의 요소로 된 대각행렬D의 곱 PD를 역시 생각해 본다. 만약에 A가 대각행렬이 맞다면 A=PDP^{-1}로 인수분해된다. 여기서 양변 우측에 P를 곱하면 AP=PD다. 실제로 식을 풀어 열단위로 대응해보면 Av_{k}에 \lambda_{k}v_{k} 가 대응되는데 가역행렬의 열들은 선형독립이고 영벡터가 아니므로 이에 대응되는 \lambda 값들은 고유벡터에 대응되는 고유값이다. 
   위에서는 고유벡터, 고유값 여부와 무관한 P와 D를 가정하고 다시 A=PDP^{-1}를 가정하여 AP=PD를 통하여 P,D의 구성성분이 고유벡터와 고유값임을 증명했다. 
   반대로 고유벡터, 고유값으로 구성된 P와 D를 만들고 AP=PD를 구하여 다시 A=PDP^{-1}임을 증명할 수도 있다.

*** 행렬의 대각화
    행렬의 대각화란 결국 행렬의 인수분해다. 다음의 4단계로 구하여 마지막 5번째 단계로 검산한다.
    1. 고유값을 찾아서 (특성방정식)
    2. 고유벡터를 구하고 ( $$ [(A- \lambda I) 0] $$ 행축약 후 매개변수 벡터형식 정리)
    3. 고유벡터로 P를 구성하고 (이것으로 P^{-1}도 구할 수 있다.)
    4. 고유값을 P의 열 순서대로 배치하여 D를 구성한다.
    5. AP = PD 가 되는지 확인함으로써 검산한다.

    유의할 것은 n정방행렬 대각화 과정에서 고유값이 n개가 아닌 경우는 가능하지만 고유벡터가 n개가 아니면 대각화가 불가능하다.
   
    #+BEGIN_QUOTE
    정리6. n정방행렬이 n개의 서로 다른 고유값을 가진다면 대각화 가능하다.(대각화의 충분조건)
    #+END_QUOTE
    증명방법: n개의 서로 다른 고유값을 가지면 그에 대응되는 n개의 고유벡터가 있다. 이 벡터집합은 n개의 고유값에 대응되는 n개의 고유벡터가 있는 것이므로 정리2에 의하여 선형독립이다. 그렇다면 정리5에 의하여 n개의 선형독립인 고유벡터를 가지는 행렬은 대각화가능행렬이다.

*** 서로 다르지 않은 고유값을 가진 행렬
    n정방행렬이 서로 다른 고유값을 가진 경우 그에 대응되는 고유벡터를 가지며 그 벡터들이 선형독립이므로 가역행렬P를 만들 수 있음을 앞에서 보았다. 서로 다르지 않는 고유값을 가진 경우는 어떨까? 그래도 정리7에 따라서 가역행렬P를 구할 수 있다. 
    #+BEGIN_QUOTE
    정리7. 고유값이 중복될 경우 고유공간 차원의 합계가 중복도와 같다면 대각화가 가능하다.
    1. k가 1이상 p이하일 때 \lambda_{k} 에 대한 고유공간의 차원은 \lambda_{k} 의 중복도와 같거나 작다.
    2. 행렬A가 대각화될 수 있는 필요충분조건은 서로 다른 고유공간의 차원들의 합이 n일 때이고
       서로 다른 고유공간의 차원들의 합이 n이 되는 것에 대한 필요충분조건은
       1) 특성다항식이 일차원 인자로 완전히 인수분해되고
       2) 각 \lambda_{k} 에 대응하는 고유공간의 차원이 \lambda_{k} 의 중복도와 같아야 한다.
    3. 행렬A가 대각화될 수 있고 B_{k} 를 각 \lambda_{k} 에 대응하는 고유공간의 기저라고 할 때
       집합 B_{1},...,B_{p} 안에 있는 모든 벡터들은 R^{n} 의 고유벡터 기저가 된다.
    #+END_QUOTE
    7(3)에서 고유값에 대응되는 고유공간의 기저의 벡터개수는 1개 이상일 수 있다. 
    그러므로 B_{k} 는 하나의 벡터라기 보다는 벡터집합이라고 보는 것이 맞을 것 같다.
    고유공간의 기저는 행렬-고유값*단위행렬의 일반해를 매개변수벡터 형식으로 나타냈을 때의 벡터들의 집합이므로
    당연히 고유벡터이다. 그런데 이 고유벡터들을 몽땅 모으면 입력공간의 기저가 된다는 것이다.
    기저가 된다는 얘기는 선형결합하면 선형독립관계에 놓인다는 것이기도 한다.
    
