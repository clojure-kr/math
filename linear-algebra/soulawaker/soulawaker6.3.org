** 6.3 직교정사영
   앞절에서 다루었던 차원을 n차원까지 확장해보자.
*** 직교 정사영의 2가지 성질
    R^n의 벡터y와 부분공간W에 대하여 다음 2가지 조건을 만족하는 벡터 $\hat{y}$ 이 W에 존재한다.
    1. $\hat{y}$ 은 $y-\hat{y}$ 가 W에 직교하는 W에 속하는 유일한 벡터이다.
    2. $\hat{y}$ 은 W에 속하는 벡터들 중에서 y에 가장 가까운 유일한 벡터이다.
**** 일차결합은 항상 두 부분으로 나뉠 수 있다.
     특히 직교기저의 일차결합에서 이 사실이 유용하다.
**** 직교기저를 두 부분으로 나누면 상호간에 직교관계가 성립한다.
     증명은 내적을 이용하여 한 부분의 원소들과 다른 부분의 곱이 결과적으로 0이 됨을 확인하면 된다.
     
   #+BEGIN_QUOTE
   정리8. 직교분해 정리(orthogonal decomposition theorem)

   R^n과 그 부분공간W가 있을 때 벡터y는 아래 형태로 유일하게 표현할 수 있다.

     $y=\hat{y}+z$                (이것을 식(1) 이라고 칭한다.)

   $\hat{y}$ 는 W에 속하고 z는 W\perp 에 속한다. W의 직교기저가 {u_1, ... , u_p}이면,

     $$ \hat{y}=\frac{y\cdot u_1}{u_1\cdot u_1}u_1 + \cdots + \frac{y\cdot u_p}{u_p\cdot u_p}u_p $$  (식(2)로 칭한다.)

   이고 $z=y-\hat{y}$ 이다.
   #+END_QUOTE

   증명은 직교내적이 0인 것을 이용하여 z에 직교기저 성분을 곱한 것이 결국 0이 됨을 확인하면 된다.

   어떤 벡터가 직교기저 집합의 모든 요소벡터에 직교하면 직교기저가 생성하는 부분공간 내부의 0점을 지나는 모든 벡터에 직교한다.
   이것을 부분공간에 속하는 모든 벡터에 직교한다고 줄여서 서술한다.

   직교분해는 특별한 기저에만 의존되지 않는다. 직교분해의 유일성은 특정 기저가 아닌 오로지 부분공간W에 의존한다.

*** 직교 정사영의 기하학적 해석
    2차원 이상의 직교 정사영은 부분공간의 차원수 만큼의 기저 요소 위로의 개별 직교 정사영으로 분해된다.

*** 정사영의 성질
    부분공간 W의 벡터 y의 W에 대한 직교 정사영 $\hat{y}$ 은 y가 된다. 즉 $proj_{w}y=y$ 이다.
    이 사실을 이용하여 최적근사 정리를 얻을 수 있다.
    #+BEGIN_QUOTE
    정리9. 최적근사 정리(best approximation theorem)

    R^n과 그 부분공간 W, R^n의 벡터y와 그것의 W위의 직교정사영 $\hat{y}$ 이 있으면
    직교정사영은 부분공간 위에서 원본벡터y에 가장 가까운 점이다. 

    직교정사영이외의 부분공간의 모든 벡터가 v이면 아래의 식이 성립한다.

      $$ \left\|y-\hat{y}\right\| < \left\|y-v\right\|$$    (식(3)으로 칭한다)
    #+END_QUOTE
    직교정사영은 가장 가까운 점이자 최적근사이기도 하다.
    y-v의 노움은 부분공간에서 y를 대체할 수 있을 정도의 근사값을 찾기 위하여 그 오차를 나타내는 것이다.
    증명은 W에서 \hat{y}와 그것이 아닌 v를 선택하여 그려본다. W에 속하는 벡터들의 기본연산 결과는 W에 속하는 벡터이다.
    그렇다면 두 벡터의 차도 W에 속한다. 직교분해정리에 의하여 y는 직교정사영과 z로 분해되는데 z 역시 W에 직교한다.
    그리고 W에 속하는 직교정사영과 v의 차도 z와 직교한다. 이럴 때 y-v는 다음과 같이 분해된다.

       $$ y-v=(y-\hat{y})+(\hat{y}-v) $$
       
    이 공식관계는 피타고라스 정리에 의한 노움 관계로 바꿔 생각해 볼 수 있다.

       $$ \left\|y-v\right\|^2 = \left\|y-\hat{y}\right\|^2 + \left\|\hat{y}-v\right\|^2 $$

    이 때 직교정사영과 v는 다르다고 가정했으므로  $$ \left\|\hat{y}-v\right\|^2 > 0 $$ 이다. 
    그러므로 z의 노움이 y-v의 노움보다 작을 수 밖에 없다.

    #+BEGIN_QUOTE
    정리10. 정규직교기저를 이용한 직교정사영 공식의 간소화

        $$ proj_{w}y=(y\cdot u_1)u_1 + (y\cdot u_2)u_2 + \cdots + (y\cdot u_p)u_p $$  (식(4)로 칭함)

    정규직교기저를 열벡터로 하는 행렬 U를 만들면 아래처럼 더욱 간소화하여 표기가능하다.   

        $$ proj_{w}y=UU^{T}y $$  (식(5))
    #+END_QUOTE
    직교분해정리의 식(2)에 정규직교기저 성분의 셀프곱이 1인 것을 적용하면 식(4)가 쉽게 나온다.
    또한 계수를 제외한 나머지를 보면 행렬 U가 됨을 알 수 있다. 벡터와 벡터곱은 행벡터와 열벡터 곱이므로
    계수 영역은 열벡터의 전치벡터를 모은 행렬에 y의 곱과 같다. 즉 U^{T}y 이다. 즉 식(5)가 나온다.

    앞서서 정규직교열벡터를 갖는 행렬의 특징을 정리6에서 보았으니
    그 행렬의 전지행렬과 그 행렬의 곱은 단위행렬이 되는 것이었다.
    여기서는 위 특징에서 행렬곱의 순서를 바꾼 것인데 직교 정사영이 나오게 되는 신기한 결과를 보여준다.

    그런데 실제계산은 식(4)보다 식(2)가 사용된다. 
