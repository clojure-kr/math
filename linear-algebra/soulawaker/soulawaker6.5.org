** 6.5 최소제곱법 문제(least square's problems)
*** 최소제곱법의 정의
    최소제곱법은 해가 없는 방정식 Ax=b 의 근사해를 구하기 위하여 고안된 방법이다.
    Ax-b 의 노움이 가장 적을 때의 x가 근사해가 되는데 Ax-b 의 노움이 바로 제곱의 제곱근이다.
    이러한 노움의 최소성과 노움이 제곱의 제곱근이라는 두 가지 특성을 붙여서 최소제곱법이라는 이름을 지었다.

    #+BEGIN_QUOTE
    정의. 최소제곱해.

    m x n 행렬 A가 있고 b\in R^m 이고, x\in R^n 일 때

       $$ \left\|b-A\hat{x}\right\| \leq \left\|b-Ax\right\| $$

    이 관계가 성립하는 \hat{x}을 연립방정식 Ax=b의 *최소제곱해* 라 한다.   
    #+END_QUOTE

*** 일반 최소제곱법 문제의 해
    표준행렬의 열공간은 선형변환의 출력 집합인 치역이다. 따라서 b가 선형변환의 해라면 열공간에 속해야 한다.
    하지만 속하지 않는다면 b가 열공간에 가장 가까운 점을 찾는 방식으로 근사할 수 있다.
    해가 없는 방정식 Ax=b에서 치역인 열공간에 b와 가장 가까운 지점이 바로 \hat{b} 이다.
    그러면 \hat{b}는 대응되는 입력인 해가 존재한다. 이 해를 \hat{x} 라고 한다. 
    (여기 \hat{x}이 직교정사영인지 아직 확인 되지 않았다. 더 아래에서 나온다)

    A\hat{x}=\hat{b} 이면 직교분해정리에 의하여 b는 \hat{b}와 b-\hat{b} 으로 분해된다.
    후자는 A의 열공간에 직교하고 열공간을 구성하는 열벡터 모두와 직교한다.
    *6.1절의 정리3 직교여공간과 행공간, 열공간, 널공간과의 관계* 에서 
    열공간은 전치행렬의 행공간과 같다. 따라서 b-\hat{b}은 전치행렬의 행공간과 직교하고 그 행벡터 모두와도 직교한다.
    그렇다면 열공간의 열벡터나 전치행렬의 행공간의 행벡터와 직교인 b-\hat{b}의 곱은 0이므로 
    이러한 관계에서 내적을 모두 모으면 \[ A^T(b - A\hat{x}) = 0 \] 가 유도된다.
    이 식을 풀면 일반적인 선형변환 앞에 표준행렬의 전치행렬을 곱한 것이 
    b 앞에 표준행렬의 전치행렬을 곱한 것과 같다는 관계가 나온다.
    이 관계식이 바로 Ax=b의 *정규방정식* 이며 정규방정식의 해가 x의 직교정사영이다.

    #+BEGIN_QUOTE
    정리13.최소제곱해들의 집합.
    Ax=b의 최소제곱해들의 집합은 정규방정식 \[ A^{T}Ax=A^{T}b \] 의 공집합이 아닌 해집합과 일치한다.
    #+END_QUOTE

    최소제곱해는 여러개 있을 수도 있고 유일하게 하나만 있을 수도 있다.

    #+BEGIN_QUOTE
    정리14. 해가 없는 선형계가 유일한 최소제곱해를 갖게 되는지 판단할 수 있는 지표들.
    
    A가 m x n 행렬일 때 아래 4가지는 동치관계에 있다.

    1. R^m에 속하는 어떤 b에 대해서도 Ax=b는 항상 유일한 최소제곱해를 갖는다.
    2. 행렬 A의 열들은 일차독립이다.
    3. A^{T}A는 가역행렬이다.
    4. Ax=b는 유일한 최소제곱해 \hat{x}을 가지며 \[ \hat{x}=(A^{T}A)^{-1}A^{T}b \] 이다.    
    #+END_QUOTE

    b와 A\hat{x} 사이의 거리를 *최소제곱오차* 라고 부른다.

*** 최소제곱해를 계산하는 다른 방법
    정규방정식에 사용되는 \[ A^{T}A \] 는 가끔 작은 오차가 발생되는데 
    이것으로 \hat{x}을 구하면 더 큰 오차를 발생시키는 경우가 있다.
    만약에 A의 열들이 선형독립이라면 QR분해에 의하여 구하는 것이 더 신뢰도가 높다.

    #+BEGIN_QUOTE
    정리15. 표준행렬의 열들이 선형독립인 경우 QR분해로 최소제곱해를 구하는 방법.
    
    열들이 선형독립인 m x n 행렬 A가 있으면 A를 QR분해할 수 있다.

    그러면 R^m 에 속하는 각각의 b에 대하여 해가 없는 방정식 Ax=b는 

    \[ \hat{x} = R^{-1}Q^{T}b \] 로 주어지는 유일한 최소제곱해를 가진다.
    #+END_QUOTE
    
    이것의 유도 과정은 없지만 증명과정은 있다.
    A\hat{x} 에서 A는 QR로 \hat{x}은 위의 최소제곱해로 대치하고 정리하면
    \[ QQ^{T}b \] 형태가 되는데, *정규직교기저를 이용한 직교정사영의 간소화된 공식* 과 형태가 동일하다.
    실제로 QR분해된 Q는 그 열들이 모행렬 A의 열공간의 정규직교기저이다. 
    그러므로 \hat{x}은 직교정사영이 맞는데 A의 열공간 위로의 직교정사영이 된다.

    #+BEGIN_QUOTE
    수치적 유의사항.

    최소제곱해를 구하기 위하여 정리15를 그대로 사용하기 위하여 R^{-1}를 구하기 보다

    \[ Rx=Q^{T}b \] 에서 가우스소거법(전진소거 후진대입)을 적용하는 것이 훨씬 더 빠르다.
    #+END_QUOTE
