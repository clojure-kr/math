** 7.2 이차형식(Quadratic Form)
   여태까지 선형방정식에 초점을 두었지만
   공학과 신호 처리에서 선형대수의 응용에는 이차형식이 빈번하게 등장한다.

   이차형식은 최고차항의 차수가 2차인 형식을 의미한다.

   R^{n}에서 이차형식은 R^{n}에 정의된 함수로서 R^{n}의 벡터x에서 값을 가지는 것이다.
   이 함수는 \[ Q(x) = x^{T}Ax \] 식으로 나타내며 이것을 계산하여 값을 구한다.
   이 때 A는 대칭행렬인데 특별히 이차형식에서는 *이차형식의 행렬* 이라고 부른다.

**** 이차형식의 행렬의 구성
     이차형식의 행렬에서 주대각성분은 차례대로 이차항인 x_{i}^{2}의 계수가 된다.
     주대각성분 이외의 나머지는 이차형식의 행렬이 대칭행렬이므로
     i번째 행과 j번째 열의 값과 j번째 행과 i번째 열의 값들이 항상 동일하며
     그 값에 2를 곱한 것이 x_{i}x_{j}항의 계수가 된다. 
     거꾸로 방정식에서 이차형식의 행렬을 구성할 때는 대각성분 이외의 성분이라면
     2로 나누어야 한다는 의미가 된다.
     만약 해당항이 없다면 계수가 0이기 때문이다. 
     반대로 대각 성분이외의 행렬 성분이 0이면 방정식의 해당항이 없다.     

*** 이차형식의 변수변환(change of variable)
    x가 R^{n}의 변수 벡터이면,
    x = Py 와 y=P^{-1}x 형태의 방정식이 *변수변환* 이다.
    이 때 P는 가역행렬이고 y는 R^{n}의 벡터이다.

    이차형식에 위 변수변환을 적용하게 되면 아래와 같이 전개된다.
    
    \[ x^{T}Ax = (Py)^{T}A(Py) = y^{T}P^{T}APy = y^{T}(P^{T}AP)y = y^{T}Dy \]

    A가 대칭행렬이므로 P^{T}AP = P^{-1}AP 가 된다.
    후자는 앞서 다뤘던 닮음행렬에서 대각화를 역으로 전개할 경우 얻게 되는 D가 된다.

    x에 대한 이차형식이 이차항 이외에 1차항의 교차곱항이 있는데
    이것을 y에 관하여 정리하게 되면 1차항이 제거된 이차항만의 식으로 변환된다.

    하지만 변환된 식의 값을 알려면 y값을 알아야 한다.
    이 때 y=P^{-1}x가 사용되는데 대칭행렬에서 P를 구할 때 단위직교벡터로 구하게 되면
    이 방정식은 y=P^{T}x 와 동치이다. 따라서 아주 쉽게 y를 구할 수 있다.
    이 y로 y^{T}Dy인 이차항만의 방정식을 쉽게 계산하면 된다.

    #+BEGIN_QUOTE
    정리4. 주축(Principle Axes) 정리.

    이차형식의 행렬이 대칭행렬인 경우에
    x^{T}Ax 를 교차곱항이 없는 y^{T}Dy로 변환하는 직교변수변환 x=Py가 있다. 
    #+END_QUOTE

*** 주축의 기하학적 관점
    이차형식의 행렬이 가역적인 대칭행렬이고 c가 상수이고 x가 이차원벡터인 경우에
    x^{T}Ax=c 는 타원이나 쌍곡선, 교차선, 한 점을 나타내거나 
    어떤 점도 갖지 않을 수 있다.

    특별히 A가 대각행렬이면 방정식의 그래프는 표준좌표에 있다.
    A가 대각행렬이 아니면 방정식의 그래프는 표준좌표의 그래프를 회전시킨 것과 같다.
    이 때 A의 주축을 찾는 것이 표준좌표계에서 그래프가 놓이는 새 좌표계를 찾는 것이 된다.
    
    A가 대각행렬이 아닐 경우 방정식은 교차곱항을 가지지만
    A의 주축을 찾아 주축이 만드는 좌표계를 기준으로 변수변환하게 되면
    교차곱항이 제거된 이차항만을 가진 방정식이 된다.
    
*** 이차형식 분류하기
    이차형식 Q의 정의역에 해당하는 x_{1}, x_{2}에 그에 대응되는 Q값을 z로하여
    (x_{1}, x_{2}, z)의 좌표를 그래프로 그리면 3차원의 독특한 그래프가 나온다.
    특히 Q가 타원형이었으면 3차원 그래프는 0에서 양의 영역으로 퍼지는 그물망 모양이
    되거나 0에서 음의 영역으로 퍼지는 그물망 모양이 된다.
    Q가 쌍곡선이었으면 3차원 그래프는 마치 말안장 모양으로 양의 영역과 음의 영역에
    걸쳐 있다.
    이차형식에서 하나의 2차항만 있는 경우에는 A4지를 완만한 곡선의 V자 형태로 굽은
    모양이 나온다.

    이런 모양새로 부터 아래의 내용을 정의할 수 있다.

    #+BEGIN_QUOTE
    정의. 이차형식 Q는

    1. x가 0 이외의 지점에서 Q값이 모두 양수인 경우 *양의 정부호(positive definite)*
    2. x가 0 이외의 지점에서 Q값이 모두 음수인 경우 *음의 정부호(negative definite)*
    3. Q값이 양수와 음수 모두 있으면 *부정부호(indefinite)* 라고 부른다.
    #+END_QUOTE

    위의 정의 1,2에서 Q값에 0이 포함된 것을 각각 *양의 반정부호*, 
    *음의 반정부호(semidefinite)* 라고 한다.

    #+BEGIN_QUOTE
    정리5. 이차형식과 고유값의 관계.

    이차형식의 행렬이 대칭행렬인 경우에
    1. 대칭행렬의 고유값이 모두 양수이면 이차형식은 양의 정부호이고
    2. 대칭행렬의 고유값이 모두 음수면 이차형식은 음의 정부호이고
    3. 대칭행렬의 고유값이 양수, 음수가 혼재하면 이차형식은 부정부호이다.
    #+END_QUOTE

    x=Py로 변수변환된 식 y^{T}Dy는 이차항만이 있다.
    여기서 D는 고유값을 성분으로 하는 대각행렬이다.
    따라서 변수변환된 이차형식의 값이 양수인지 음수인지 여부는 결국
    이차항의 계수를 결정하는 D의 성분인 고유값의 부호에 달려있게 된다.
    그러므로 위 정리5는 타당하다.

    이차형식의 분류는 이처럼 이차형식의 행렬을 분석하는 것이 손쉬울 수 있다.
    이차형식의 공역이 양의 정부호인 경우 이차형식의 행렬을 
    *양의 정부호 행렬(positive definite matrix)* 이라고 부른다.
    마찬가지 논리로 양의 반정부호 행렬, 음의 정부호 행렬 부정부호 행렬 따위가 있겠다.

    #+BEGIN_QUOTE
    수치적 유의사항. 이차형식 행렬이 양의 정부호인지 빠르게 파악하는 방법.

    이차형식 행렬을 R^{T}R로 행렬분해하는 것이다.
    이 때 R은 양의 대각성분을 가진 상삼각행렬이다.
    이런 분해는 오로지 행렬이 양의 정부호일 때에만 가능하다.
    #+END_QUOTE
