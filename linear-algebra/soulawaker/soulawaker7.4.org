** 7.4 특이값 분해(singular value decomposition)
   대각화 즉 행렬분해 A=PDP^{-1}는 일부 행렬에만 적용가능하다.
   하지만 특이값분해 A=QDP^{-1}는 모든 행렬에 적용가능하다!

   일반 대각화 대상 행렬 A에서 관찰되는 성질 중 일부는  
   직사각행렬에도 유사하게 적용된다.

   그것은 A의 고유값의 절대값이 고유벡터를 변동시키는 양이 되는 것이다.   
   식으로 표현하면 Ax의 길이에 정규화된 단위고유벡터와 대응되는 고유값을 넣는다. 

     \[ \left\|Ax\right\| = |\lambda|\left\|x\right\| = |\lambda| \]
   
   직사각행렬은 A^{T}A 로 대칭행렬을 만들어 그것의 고유값과 단위고유벡터를 구한다.
   이 고유값과 단위고유벡터의 관계가 위의 관계와 비슷하게 관찰된다.
   
*** m x n 행렬의 특이값
    A^{T}A의 단위고유벡터 v_{i}와 그에 대응되는 고유값 \lambda_{i}는
    아래의 관계가 성립된다.
       \[ \left\|Av_{i}\right\|^{2} = \lambda_{i} \]
    A의 특이값은 AV_{i}의 길이 즉 A^{T}A의 고유값의 루트값이다.

    Av_{1}과 Av_{2}의 내적을 구해보면 0이 되므로 서로 직교관계임을 알 수 있다.
    이것은 우연이 아니다. 아래 정리9의 관계가 성립되는 것이다.

    #+BEGIN_QUOTE
    정리9. A^{T}A의 고유벡터로 구성되는 R^{n}의 직교기저의 집합인
    {v_{1}, ... , v_{n}} 이 그에 대응되는 고유값들의 크기순서에 따라 
    정렬되어 있고, A가 r개의 0이 아닌 특이값을 가진다고 가정한다.
    그러면 {Av_{1}, ... , Av_{r}}은 열공간 A의 직교 기저이고
    rank A = r 이다.
    #+END_QUOTE

    #+BEGIN_QUOTE
    수치적 유의사항.

    행렬A의 계수를 A의 기약행렬을 구하여 추축열을 샘하는 방법으로 계산하는 것은
    반올림오차 때문에 부정확하다. 
    A의 0이 아닌 특이값의 개수를 샘하는 것이 훨씬 더 신뢰할 수 있는 방법이다.
    이 때 극도로 작은 특이값은 0으로 추정하여 배제하고 나머지 0이 아닌 특이값을
    샘하여 유효 계수를 구한다.
    #+END_QUOTE

*** 특이값 분해(Singular Value Decomposition)
    m x n 대각 행렬 \sum 은
    특이값을 주대각 성분으로 하는 D와 
    0으로 구성된 행과 열이 있을 수도 있고 없을 수도 있는 행렬이다.
    r개의 특이값이 있을 때 0으로 구성된 행의 개수는 m-r 개이며
    0으로 구성된 열의 개수는 n-r 개가 된다.

    #+BEGIN_QUOTE
    정리10. 특이값분해 SVD

    A가 계수 r의 m x n 행렬이라고 하자.
    그러면 m x n 행렬 \sum 과 직교행렬 U와 V로 구성된 아래의 관계가 성립한다.

      \[ A = U\sumV^{T} \]
    #+END_QUOTE

    U의 열들을 A의 좌특이벡터들, V의 열들을 A의 우특이벡터들이라고 부른다.
    U\sum 는 계산해보면 AV가 된다.

    직사각행렬 A의 특이값 분해를 구하는 과정은 아래와 같다.
    1. A^{T}A 의 직교대각화를 구하여 고유값과 단위고유벡터를 구한다.
    2. 단위고유벡터로 V를 구성하고, 고유값으로 특이값을 구하여 \sum 을 구성한다.
    3. Av_{i}를 정규화한 u_{i}들로 U를 구성한다.
       이 때 0이 아닌 고유값이 n개에 미달하여 n x n 행렬U를 구성못할 수 있다.
       이럴 때는 Av_{i}가 정규화된 u_{i} 역시 서로 직교관계인 것을 고려하여
       u_{i}^{T}x=0 의 관계를 만족하는 기저들을 구하고
       그 기저들 중 u_{i}와 직교관계인 것부터 시작하여
       그람슈미트 과정을 적용하여 직교관계인 나머지 열들을 구할 수 있다.
       
*** 특이값 분해의 응용
    여기서는 4가지 예시를 든다. 이미지 처리에 응용은 7.5절에서 소개한다.
**** 조건수(The Condition Number)
     가역행렬 A의 최고특이값과 최소특이값의 비율이 조건수이다.

     Ax=b의 계산은 SVD를 이용할 때 신뢰할 수 있는데
     SVD 중에서도 U, V는 벡터의 길이나 각도에 영향을 주지않고
     오로지 \sum이 영향을 미친다. 특이값이 극단적으로 크거나 작으면 반올림오차는
     거의 필연적이다. 다만 \sum과 V의 성분을 앎으로써 오차를 분석할 수 있다. 

     Ax=b의 해를 구하는데 조건수가 어떤 역할을 하는지는 연습문제를 풀어본다.
**** 기본부분공간의 기저(Bases for Fundamental Subspaces)
     *Row A* 는 A를 거쳐서 *Row A^{T}(=Col A)* 가 된다.
     *Nul A* 는 A를 거쳐서 *Nul A^{T}* 가 된다.
     Row A는 NulA에 직교여공간 관계에 있다.
     Row A^{T}는 Nul A^{T}에 직교여공간 관계 있다.

     위 4가지 부분공간과 특이값의 개념이 가역행렬정리의 마지막 문장을 제공한다.
     #+BEGIN_QUOTE
     가역행렬정리(마무리)
     A가 nxn 행렬일 때, 아래의 문장들은 A가 가역행렬이라는 문장과 동치이다.

     u. (Col A)^{\perp} = {0}
     v. (Nul A)^{\perp} = R^{n}
     w. Row A = R^{n}
     x. A는 n개의 0이 아닌 특이값을 가진다.
     #+END_QUOTE
**** 기약SVD와 A의 유사역행렬(Reduced SVD and the Pseudoinverse of A)
     m x n 행렬 \sum에 0으로 된 행이나 열이 있으면 SVD는
     A=U_{r}DV_{r}^{T}로 추약될 수 있다.
     이러한 행렬분해를 *기약특이값분해* 라고 한다.
     A가 기약특이값분해 형태일 때 A는 아래 형태로 된 
     유사역행렬(또는 Moore-Penrose 역행렬) 을 가정해볼수 있다.
 
         A^{+} = V_{r}D^{-1}U_{r}^{T} 
**** 최소제곱해
     Ax=b에 위의 유사역행렬을 적용하면 직교정사영을 아래처럼 정의할 수 있다.

       \hat{x}=A^{+}b=V_{r}D^{-1}U_{r}^{T}b
     
     위의 식 양변에 A를 곱하면 A\hat{x}=U_{r}U_{r}^{T}b 가 되는데
     우변은 b의 직교정사영 \hat{b}을 나타내는 것이다.
     따라서 \hat{x}은 Ax=b의 최소제곱해가 되는데, 
     최소제곱해 중에서도 가장 작은 길이를 가지는 것이다.

     #+BEGIN_QUOTE
     수치적 유의사항.

     실무에서는 A^{T}A 계산은 오차 때문에 피한다.
     더 빠르고 정확한 방법들이 사용된다.
     #+END_QUOTE
