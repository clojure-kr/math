** 7.5 영상정보처리와 통계에의 응용
   주성분 분석은 사물이나 사람의 집단에서 만들어진 측정 목록에 적용가능하다.
   이 때 측정요소x측정표본수 관측행렬을 구성할 수 있다. 측정요소 수가 차원의 수이다.
   관측행렬의 한 열이 바로 하나의 표본의 관측된 데이터이며 관측벡터라 부른다.

   만약 2차원 데이터의 N개의 표본들을 그래프로 표현하면 흩어진 점들로 나타난다.

   7장 도입부의 위성사진들을 상기해보면
   동일 장소에서 3개의 서로 다른 파장으로 측정된 성분들을 하나의 관측행렬로 구성했다.
   사진 하나의 픽셀이 2000x2000 인데 이것을 1차원 4백만으로 바꿔볼 수 있다.
   그러면 3개파장x4백만픽셀 관측행렬이 구성된다.
   
   사진 하나는 두 개의 공간 차원으로 구성되지만
   3가지 사진을 하나로 종합하여 구성하는 관측행렬 측면에서는 3가지 스펙트럼 차원이 된다.
   사진의 픽셀데이터는 각 점의 위치에서의 표본이 된다.

*** 평균과 공분산(Mean and Covariance)
    관측행렬의 각 열벡터 즉 표본을 모두 더하여 표본수로 나누면 표본 평균을 얻을 수 있다.
    *표본평균(sample mean)* 은 그래프 상에서 분포된 표본의 중심점이다. M으로 표기한다.
    이 표본평균을 관측행렬의 각 표본에 빼주면 *평균편차형식(mean-deviation form)* 
    을 구할 수 있다. 평균편차형식을 그래프로 나타내어 보면 분포를 유지한 상태로 중심점만 
    원점으로 이동한 것을 볼 수 있다. B로 표기한다.

    평균편차형식을 이용하여 *(표본)공분산행렬(sample covariece matrix)* 을 구할 수 있다.
    구하는 공식은 다음과 같다.
      \[ S = \frac{1}{N-1}BB^{T} \]
    보통 S로 표기하는데 공식에서 보이듯 BB^{T} 덕분에 
    양의 반정부호(positive *S* emidefinite)가 되기 때문이다.

    공분산행렬의 대각성분은 *분산(variance)* 을 나타내는데
    각 위치에 해당하는 측정요소의 분산 정도를 나타낸다.
    이 분산들을 한데 합한 것이 *총분산(total variance)* 이다. *tr(S)* 로 표기한다.

    공분산행렬에서 대각성분을 제외한 성분들을 *공분산(covariece)* 이라고 부른다.
    각 공분산은 행번째의 측정요소와 열번째의 측정요소와의 공통된 분산 정도를 나타낸다. 
    따라서 공분산이 0이면 각 요소는 *상관관계가 없다(uncorrelated)*  

*** 주성분 분석(Principle Component Analysis)
    평균편차형식을 X라 할 때 X=PY 로 변수변환을 시키는 P를 찾는 것이 주성분 분석이다.
    평균편차형식으로 공분산행렬 S를 구한 뒤 S를 PDP^{T} 로 직교대각화하면 P를 얻는다.
    주성분이란 P의 열들을 의미하는데 
    P의 열들은 공분산행렬의 단위 직교벡터들이므로
    공분산행렬의 단위 직교벡터들이 바로 관측행렬의 주성분이다.
    그렇다면 X=PY 에서 Y가 바로 D가 된다.
    즉 Y=P^{T}X, 평균편차형식이 주성분의 전치행렬을 거치면 공분산행렬이 분해된 D가
    구해진다.

    주성분이 Y의 열의 요소들을 결정하는 과정을 관찰해보면
    주성분의 각 요소가 X의 열의 요소들에 가중치로 작용하는 것을 알게 된다.

    D는 공분산행렬S를 변수변환하여 모든 공분산이 0이고 분산만 남긴 것이다.
    S의 분산이 측정요소 하나의 분산이라면 
    D의 분산은 모든 측정요소의 분산이 주성분만큼 가중되어 합쳐진 것이다. 
    즉 D는 하나의 분산에 모든 측정요소가 들어가 있는 것이다.
    따라서 D의 분산 중 월등히 큰 것만 추리고 미미한 것은 버려도 지장이 없다.

    7장 도입부 위성사진의 경우 X의 열의 각 성분값들(측정요소들)이 각 3개의 사진이다.
    이것들을 주성분 분석으로 하나의 사진으로 간략화했다. 
    먼저 공분산행렬을 구하고 대각화하여 D를 구해보니 첫번째 분산이 가장 크고 
    나머지는 미미하므로 무시하여 1차원 데이터로 취급한 것이다.

*** 다변수 자료의 차원 축소(Reducing the Dimension of Multivariate Data)
    주성분 분석은 데이터의 변화가 소수의 변수들의 변화 때문인 경우에 가치가 있다.
    직교변수변환 X=PY는 총분산을 변화시키지 않는다. 그러므로 관측행렬의 총분산 tr(S)는
    D의 대각성분의 합과 동일하다. D의 대각성분/tr(S) 는 그 성분으로 설명 또는 포착되는
    총분산의 비율이다.

    이것을 위성사진의 수치에 적용해보면 분산의 비율을 퍼센트로 구할 수 있다.
    첫번째 비율은 93프로 정도이고 두번째는 5프로 세번째는 1프로 정도인데
    이 비율을 이용하여 만들어진 3가지 사진 중 첫번째 것만 대부분의 데이터가 들어 있다.
    기하학적으로 보게 되면 세번째는 거의 0에 가까우므로 첫번째와 두번째 데이터만으로도
    데이터 점들의 위치가 거의 정확하게 결정될 수 있다. 두번째도 분산이 적은데
    그렇게 되면 점들이 거의 선에 가깝게 배치되게 된다. 
    그러므로 데이터는 본질적으로 1차원이 된다.

*** 주성분 변수의 특성(Characterizations of Principle Component Variables) 
    주성분인 가중치와 표본의 성분들의 선형결합이 바로 주성분 변수 y이다. 
    Y(내지는 D)의 성분이다. y=u^{T}X 이면서 y=u^{T}Su 이기도 하다. 
    단위고유벡터 u는 S의 고유값에 대응된다.
    주성분 변수는 크기 순서대로 배치되며 단위고유벡터 역시 마찬가지다.
    '가장 큰 주성분 변수와 무관계한 나머지 변수들' 사이에서 최대값을 찾으면 
    그것이 다음 순서의 주성분 변수가 된다.
    #+BEGIN_QUOTE
    수치적 유의사항. \\
    실무에서 특이값분해가 주성분분석에 사용된다. B가 pxN 관측행렬의 평균편차형식이고
    \[ A=(\frac{1}{\sqrt{N-1}})B^{T} \]라고 가정하면 A^{T}A가 S가 된다. 그리고 A의 우특이벡터가
    관측행렬의 주성분이 된다. S의 고유값분해 보다 A의 특이값분해가 빠르고 더 정확하다. 
    #+END_QUOTE
    
